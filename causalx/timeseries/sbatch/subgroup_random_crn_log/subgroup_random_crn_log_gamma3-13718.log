[2024-09-27 07:01:11 +0000] [2091096] [INFO] Starting gunicorn 22.0.0
[2024-09-27 07:01:11 +0000] [2091096] [INFO] Listening at: http://127.0.0.1:8099 (2091096)
[2024-09-27 07:01:11 +0000] [2091096] [INFO] Using worker: sync
[2024-09-27 07:01:11 +0000] [2091098] [INFO] Booting worker with pid: 2091098
[2024-09-27 07:01:11 +0000] [2091099] [INFO] Booting worker with pid: 2091099
[2024-09-27 07:01:11 +0000] [2091100] [INFO] Booting worker with pid: 2091100
[2024-09-27 07:01:12 +0000] [2091101] [INFO] Booting worker with pid: 2091101
runnables/train_enc_dec.py:18: UserWarning: 
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
  @hydra.main(config_name=f'config.yaml', config_path='../config/')
[[36m2024-09-27 07:01:24,373[0m][[34m__main__[0m][[32mINFO[0m] - 
model:
  dim_treatments: 4
  dim_vitals: 0
  dim_static_features: 1
  dim_outcomes: 1
  name: CRN
  encoder:
    _target_: src.models.crn.CRNEncoder
    seq_hidden_units: 24
    br_size: 24
    fc_hidden_units: 96
    dropout_rate: 0.2
    num_layer: 1
    batch_size: 1024
    optimizer:
      optimizer_cls: adam
      learning_rate: 0.005
      weight_decay: 0.0
      lr_scheduler: false
    tune_hparams: false
    tune_range: 50
    hparams_grid: null
    resources_per_trial: null
  train_decoder: true
  decoder:
    _target_: src.models.crn.CRNDecoder
    seq_hidden_units: null
    br_size: 18
    fc_hidden_units: 9
    dropout_rate: 0.1
    num_layer: 1
    batch_size: 4096
    optimizer:
      optimizer_cls: adam
      learning_rate: 0.01
      weight_decay: 0.0
      lr_scheduler: false
    tune_hparams: false
    tune_range: 30
    hparams_grid: null
    resources_per_trial: null
dataset:
  val_batch_size: 512
  treatment_mode: multiclass
  _target_: src.data.SyntheticCancerDatasetCollection
  name: tumor_generator
  coeff: 3.0
  chemo_coeff: 3.0
  radio_coeff: 3.0
  seed: 10
  random: true
  num_patients:
    train: 10000
    val: 1000
    test: 1000
  window_size: 15
  lag: 0
  max_seq_length: 60
  projection_horizon: 5
  cf_seq_mode: sliding_treatment
exp:
  seed: 10
  gpus:
  - 0
  max_epochs: 200
  logging: true
  mlflow_uri: http://127.0.0.1:5000
  unscale_rmse: true
  percentage_rmse: true
  alpha: 0
  update_alpha: true
  alpha_rate: exp
  balancing: subgroup
  bce_weight: false
  weights_ema: true
  beta: 0.99
  alpha_wass: 0.001
  alpha_wass_epoch: false
  alpha_wass_growth: 0.001
  alpha_wass_max: 0.01
  num_timepoints: 59
[0m
/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/hydra/_internal/hydra.py:119: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/1.2/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  ret = run_job(
Global seed set to 10
[[36m2024-09-27 07:01:24,416[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-27 07:01:24,419[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-27 07:01:24,420[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-27 07:01:24,421[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-27 07:01:24,423[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-27 07:01:24,456[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 4658 patients[0m
[[36m2024-09-27 07:01:24,461[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 9338 patients[0m
[[36m2024-09-27 07:01:24,466[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 13912 patients[0m
[[36m2024-09-27 07:01:24,473[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-27 07:01:24,478[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m
  0%|          | 0/10000 [00:00<?, ?it/s]/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer_avg/src/data/cancer_sim/cancer_simulation.py:346: RuntimeWarning: overflow encountered in exp
  if recovery_rvs[i, t] < np.exp(-cancer_volume[i, t] * TUMOUR_CELL_DENSITY):
  1%|          | 68/10000 [00:00<00:14, 674.81it/s]  1%|â–         | 140/10000 [00:00<00:14, 697.20it/s]  2%|â–         | 210/10000 [00:00<00:14, 691.62it/s]  3%|â–Ž         | 280/10000 [00:00<00:14, 689.04it/s]  4%|â–Ž         | 350/10000 [00:00<00:13, 691.43it/s]  4%|â–         | 422/10000 [00:00<00:13, 697.62it/s]  5%|â–         | 493/10000 [00:00<00:13, 701.32it/s]  6%|â–Œ         | 564/10000 [00:00<00:13, 700.64it/s]  6%|â–‹         | 635/10000 [00:00<00:14, 639.87it/s]  7%|â–‹         | 703/10000 [00:01<00:14, 649.92it/s]  8%|â–Š         | 773/10000 [00:01<00:13, 662.54it/s]  8%|â–Š         | 841/10000 [00:01<00:13, 667.54it/s]  9%|â–‰         | 910/10000 [00:01<00:13, 671.73it/s] 10%|â–‰         | 980/10000 [00:01<00:13, 677.44it/s] 11%|â–ˆ         | 1052/10000 [00:01<00:13, 687.26it/s] 11%|â–ˆ         | 1121/10000 [00:01<00:12, 686.00it/s] 12%|â–ˆâ–        | 1193/10000 [00:01<00:12, 693.60it/s] 13%|â–ˆâ–Ž        | 1263/10000 [00:01<00:12, 690.10it/s] 13%|â–ˆâ–Ž        | 1333/10000 [00:01<00:12, 683.21it/s] 14%|â–ˆâ–        | 1402/10000 [00:02<00:12, 680.40it/s] 15%|â–ˆâ–        | 1471/10000 [00:02<00:12, 677.19it/s] 15%|â–ˆâ–Œ        | 1542/10000 [00:02<00:12, 686.06it/s] 16%|â–ˆâ–Œ        | 1616/10000 [00:02<00:11, 699.10it/s] 17%|â–ˆâ–‹        | 1686/10000 [00:02<00:11, 694.12it/s] 18%|â–ˆâ–Š        | 1758/10000 [00:02<00:11, 701.24it/s] 18%|â–ˆâ–Š        | 1829/10000 [00:02<00:11, 701.63it/s] 19%|â–ˆâ–‰        | 1900/10000 [00:02<00:11, 678.14it/s] 20%|â–ˆâ–‰        | 1968/10000 [00:02<00:12, 636.32it/s] 20%|â–ˆâ–ˆ        | 2033/10000 [00:03<00:12, 623.82it/s] 21%|â–ˆâ–ˆ        | 2102/10000 [00:03<00:12, 639.98it/s] 22%|â–ˆâ–ˆâ–       | 2171/10000 [00:03<00:11, 653.72it/s] 22%|â–ˆâ–ˆâ–       | 2242/10000 [00:03<00:11, 668.76it/s] 23%|â–ˆâ–ˆâ–Ž       | 2310/10000 [00:03<00:11, 662.47it/s] 24%|â–ˆâ–ˆâ–       | 2377/10000 [00:03<00:12, 623.74it/s] 24%|â–ˆâ–ˆâ–       | 2449/10000 [00:03<00:11, 649.48it/s] 25%|â–ˆâ–ˆâ–Œ       | 2520/10000 [00:03<00:11, 664.77it/s] 26%|â–ˆâ–ˆâ–Œ       | 2588/10000 [00:03<00:11, 667.15it/s] 27%|â–ˆâ–ˆâ–‹       | 2661/10000 [00:03<00:10, 684.05it/s] 27%|â–ˆâ–ˆâ–‹       | 2734/10000 [00:04<00:10, 695.74it/s] 28%|â–ˆâ–ˆâ–Š       | 2804/10000 [00:04<00:10, 689.29it/s] 29%|â–ˆâ–ˆâ–‰       | 2877/10000 [00:04<00:10, 698.83it/s] 29%|â–ˆâ–ˆâ–‰       | 2947/10000 [00:04<00:10, 696.61it/s] 30%|â–ˆâ–ˆâ–ˆ       | 3018/10000 [00:04<00:10, 697.51it/s] 31%|â–ˆâ–ˆâ–ˆ       | 3088/10000 [00:04<00:09, 698.16it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 3158/10000 [00:04<00:09, 696.05it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 3228/10000 [00:04<00:09, 695.18it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3301/10000 [00:04<00:09, 703.27it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 3372/10000 [00:04<00:09, 699.62it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 3442/10000 [00:05<00:09, 696.45it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 3512/10000 [00:05<00:09, 691.49it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 3583/10000 [00:05<00:09, 696.67it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 3656/10000 [00:05<00:09, 703.83it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 3727/10000 [00:05<00:09, 693.94it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 3797/10000 [00:05<00:08, 693.62it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 3869/10000 [00:05<00:08, 700.76it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 3940/10000 [00:05<00:08, 697.38it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4010/10000 [00:05<00:08, 695.42it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4080/10000 [00:05<00:08, 691.85it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4150/10000 [00:06<00:08, 691.81it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4220/10000 [00:06<00:08, 691.96it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 4290/10000 [00:06<00:08, 692.05it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 4360/10000 [00:06<00:08, 687.97it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4429/10000 [00:06<00:08, 685.47it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 4500/10000 [00:06<00:07, 690.85it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 4570/10000 [00:06<00:07, 689.11it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 4639/10000 [00:06<00:07, 686.68it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 4709/10000 [00:06<00:07, 689.22it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 4780/10000 [00:06<00:07, 692.61it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 4850/10000 [00:07<00:07, 691.84it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 4920/10000 [00:07<00:07, 694.06it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 4990/10000 [00:07<00:07, 687.03it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5059/10000 [00:07<00:07, 687.42it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5129/10000 [00:07<00:07, 690.83it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5199/10000 [00:07<00:06, 691.56it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 5269/10000 [00:07<00:06, 689.52it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 5338/10000 [00:07<00:06, 688.10it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5407/10000 [00:07<00:06, 671.88it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5478/10000 [00:08<00:06, 682.91it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5547/10000 [00:08<00:06, 683.50it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5618/10000 [00:08<00:06, 689.14it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 5691/10000 [00:08<00:06, 698.38it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 5762/10000 [00:08<00:06, 699.70it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 5832/10000 [00:08<00:05, 696.70it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 5903/10000 [00:08<00:05, 700.42it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 5974/10000 [00:08<00:05, 697.92it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6044/10000 [00:08<00:05, 690.65it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6115/10000 [00:08<00:05, 693.78it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6185/10000 [00:09<00:05, 692.94it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 6256/10000 [00:09<00:05, 697.86it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 6326/10000 [00:09<00:05, 693.74it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6398/10000 [00:09<00:05, 700.95it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6469/10000 [00:09<00:05, 692.06it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 6539/10000 [00:09<00:05, 690.82it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 6609/10000 [00:09<00:04, 688.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6678/10000 [00:09<00:04, 683.79it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6749/10000 [00:09<00:04, 690.90it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 6819/10000 [00:09<00:04, 645.18it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 6889/10000 [00:10<00:04, 660.00it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 6958/10000 [00:10<00:04, 666.04it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7027/10000 [00:10<00:04, 670.67it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7102/10000 [00:10<00:04, 692.44it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7172/10000 [00:10<00:04, 690.46it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7244/10000 [00:10<00:03, 696.44it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 7314/10000 [00:10<00:03, 695.00it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7386/10000 [00:10<00:03, 699.80it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7458/10000 [00:10<00:03, 703.99it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 7529/10000 [00:10<00:03, 698.53it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 7600/10000 [00:11<00:03, 699.02it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 7670/10000 [00:11<00:03, 696.88it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 7740/10000 [00:11<00:03, 694.00it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7810/10000 [00:11<00:03, 693.36it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 7882/10000 [00:11<00:03, 700.27it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 7953/10000 [00:11<00:02, 700.12it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8024/10000 [00:11<00:02, 694.50it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8094/10000 [00:11<00:02, 687.97it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8164/10000 [00:11<00:02, 689.22it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8233/10000 [00:12<00:02, 687.32it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 8303/10000 [00:12<00:02, 688.89it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 8372/10000 [00:12<00:02, 684.03it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8441/10000 [00:12<00:02, 683.41it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 8510/10000 [00:12<00:02, 683.51it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 8579/10000 [00:12<00:02, 680.03it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 8652/10000 [00:12<00:01, 694.75it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 8722/10000 [00:12<00:01, 691.10it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 8792/10000 [00:12<00:01, 689.27it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 8861/10000 [00:12<00:01, 688.25it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8932/10000 [00:13<00:01, 693.01it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9002/10000 [00:13<00:01, 687.35it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9072/10000 [00:13<00:01, 689.34it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9145/10000 [00:13<00:01, 698.58it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9215/10000 [00:13<00:01, 697.09it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 9285/10000 [00:13<00:01, 695.04it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 9357/10000 [00:13<00:00, 700.02it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9428/10000 [00:13<00:00, 694.78it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9498/10000 [00:13<00:00, 696.21it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 9569/10000 [00:13<00:00, 697.38it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 9639/10000 [00:14<00:00, 693.07it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 9709/10000 [00:14<00:00, 689.73it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 9778/10000 [00:14<00:00, 687.79it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 9847/10000 [00:14<00:00, 684.01it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 9916/10000 [00:14<00:00, 683.87it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 9986/10000 [00:14<00:00, 687.98it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10000/10000 [00:14<00:00, 686.76it/s]Modified current_covariates:
[[36m2024-09-27 07:01:39,368[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Processing train dataset before training[0m
[[36m2024-09-27 07:01:40,322[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Shape of processed train data: {'cancer_volume': (10000, 60), 'chemo_dosage': (10000, 60), 'radio_dosage': (10000, 60), 'chemo_application': (10000, 60), 'radio_application': (10000, 60), 'chemo_probabilities': (10000, 60), 'radio_probabilities': (10000, 60), 'sequence_lengths': (10000,), 'death_flags': (10000, 60), 'recovery_flags': (10000, 60), 'patient_types': (10000,), 'prev_treatments': (10000, 59, 4), 'current_treatments': (10000, 59, 4), 'current_covariates': (10000, 59, 2), 'outputs': (10000, 59, 1), 'active_entries': (10000, 59, 1), 'unscaled_outputs': (10000, 59, 1), 'prev_outputs': (10000, 59, 1), 'static_features': (10000, 1)}[0m
before change [-0.10472591 -1.23120471]
after change [-0.03583885  0.09391788]
before change [-0.14468863 -1.23120471]
after change [-0.14391977  0.22986788]
[[36m2024-09-27 07:01:40,374[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-27 07:01:40,375[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-27 07:01:40,376[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-27 07:01:40,377[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-27 07:01:40,377[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-27 07:01:40,380[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 455 patients[0m
[[36m2024-09-27 07:01:40,381[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 905 patients[0m
[[36m2024-09-27 07:01:40,382[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 1366 patients[0m
[[36m2024-09-27 07:01:40,383[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-27 07:01:40,384[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m

  0%|          | 0/1000 [00:00<?, ?it/s]/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer_avg/src/data/cancer_sim/cancer_simulation.py:346: RuntimeWarning: overflow encountered in exp
  if recovery_rvs[i, t] < np.exp(-cancer_volume[i, t] * TUMOUR_CELL_DENSITY):
  7%|â–‹         | 69/1000 [00:00<00:01, 688.00it/s] 14%|â–ˆâ–        | 138/1000 [00:00<00:01, 687.51it/s] 21%|â–ˆâ–ˆ        | 207/1000 [00:00<00:01, 684.31it/s] 28%|â–ˆâ–ˆâ–Š       | 278/1000 [00:00<00:01, 691.56it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 348/1000 [00:00<00:00, 687.24it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 420/1000 [00:00<00:00, 695.01it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 490/1000 [00:00<00:00, 696.21it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 560/1000 [00:00<00:00, 695.78it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 631/1000 [00:00<00:00, 699.54it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 702/1000 [00:01<00:00, 701.58it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 773/1000 [00:01<00:00, 696.87it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 843/1000 [00:01<00:00, 696.23it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 913/1000 [00:01<00:00, 696.90it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 983/1000 [00:01<00:00, 697.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:01<00:00, 694.93it/s][[36m2024-09-27 07:01:41,828[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-27 07:01:41,829[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-27 07:01:41,829[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-27 07:01:41,830[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-27 07:01:41,831[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-27 07:01:41,832[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 493 patients[0m
[[36m2024-09-27 07:01:41,833[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 947 patients[0m
[[36m2024-09-27 07:01:41,834[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 1403 patients[0m
[[36m2024-09-27 07:01:41,835[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-27 07:01:41,836[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m

  0%|          | 0/1000 [00:00<?, ?it/s]  2%|â–         | 15/1000 [00:00<00:07, 140.65it/s]  3%|â–Ž         | 30/1000 [00:00<00:06, 143.26it/s]  4%|â–         | 45/1000 [00:00<00:06, 143.09it/s]  6%|â–Œ         | 60/1000 [00:00<00:06, 143.09it/s]  8%|â–Š         | 75/1000 [00:00<00:06, 142.97it/s]  9%|â–‰         | 90/1000 [00:00<00:06, 145.26it/s] 10%|â–ˆ         | 105/1000 [00:00<00:06, 146.71it/s] 12%|â–ˆâ–        | 120/1000 [00:00<00:06, 145.49it/s] 14%|â–ˆâ–Ž        | 136/1000 [00:00<00:05, 147.49it/s] 15%|â–ˆâ–Œ        | 151/1000 [00:01<00:05, 146.01it/s] 17%|â–ˆâ–‹        | 166/1000 [00:01<00:05, 145.01it/s] 18%|â–ˆâ–Š        | 181/1000 [00:01<00:05, 144.29it/s] 20%|â–ˆâ–‰        | 196/1000 [00:01<00:05, 143.81it/s] 21%|â–ˆâ–ˆ        | 211/1000 [00:01<00:05, 143.53it/s] 23%|â–ˆâ–ˆâ–Ž       | 227/1000 [00:01<00:05, 146.22it/s] 24%|â–ˆâ–ˆâ–       | 242/1000 [00:01<00:05, 145.29it/s] 26%|â–ˆâ–ˆâ–Œ       | 257/1000 [00:01<00:05, 144.63it/s] 27%|â–ˆâ–ˆâ–‹       | 273/1000 [00:01<00:04, 146.96it/s] 29%|â–ˆâ–ˆâ–‰       | 288/1000 [00:01<00:04, 147.68it/s] 30%|â–ˆâ–ˆâ–ˆ       | 303/1000 [00:02<00:04, 146.25it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 318/1000 [00:02<00:04, 145.44it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 336/1000 [00:02<00:04, 153.01it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 352/1000 [00:02<00:04, 152.52it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 368/1000 [00:02<00:04, 151.43it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 384/1000 [00:02<00:04, 149.27it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 399/1000 [00:02<00:04, 147.23it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 414/1000 [00:02<00:03, 147.73it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 431/1000 [00:02<00:03, 152.65it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 448/1000 [00:03<00:03, 156.68it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 464/1000 [00:03<00:03, 154.84it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 480/1000 [00:03<00:03, 152.07it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 496/1000 [00:03<00:03, 151.95it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 512/1000 [00:03<00:03, 151.82it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 528/1000 [00:03<00:03, 152.82it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 546/1000 [00:03<00:02, 158.03it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 562/1000 [00:03<00:02, 153.15it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 580/1000 [00:03<00:02, 160.75it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 598/1000 [00:03<00:02, 164.11it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 618/1000 [00:04<00:02, 173.15it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 636/1000 [00:04<00:02, 173.41it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 655/1000 [00:04<00:01, 176.70it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 673/1000 [00:04<00:01, 174.88it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 691/1000 [00:04<00:01, 174.85it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 709/1000 [00:04<00:01, 173.71it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 727/1000 [00:04<00:01, 163.00it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 744/1000 [00:04<00:01, 159.20it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 761/1000 [00:04<00:01, 153.85it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 777/1000 [00:05<00:01, 153.02it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 793/1000 [00:05<00:01, 151.82it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 809/1000 [00:05<00:01, 148.91it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 824/1000 [00:05<00:01, 147.62it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 839/1000 [00:05<00:01, 146.01it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 854/1000 [00:05<00:01, 144.89it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 869/1000 [00:05<00:00, 144.08it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 884/1000 [00:05<00:00, 143.49it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 899/1000 [00:05<00:00, 143.13it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 914/1000 [00:06<00:00, 142.81it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 929/1000 [00:06<00:00, 142.62it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 944/1000 [00:06<00:00, 142.41it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 959/1000 [00:06<00:00, 142.38it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 974/1000 [00:06<00:00, 142.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 989/1000 [00:06<00:00, 142.55it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:06<00:00, 150.76it/s]Call to simulate counterfactuals data
[[36m2024-09-27 07:01:48,471[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-27 07:01:48,473[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-27 07:01:48,473[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-27 07:01:48,474[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-27 07:01:48,475[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-27 07:01:48,476[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 445 patients[0m
[[36m2024-09-27 07:01:48,477[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 895 patients[0m
[[36m2024-09-27 07:01:48,478[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 1355 patients[0m
[[36m2024-09-27 07:01:48,479[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-27 07:01:48,480[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m

  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 4/1000 [00:00<00:25, 38.82it/s]  1%|          | 8/1000 [00:00<00:25, 38.91it/s]  1%|          | 12/1000 [00:00<00:25, 39.06it/s]  2%|â–         | 16/1000 [00:00<00:25, 38.90it/s]  2%|â–         | 20/1000 [00:00<00:25, 38.89it/s]  2%|â–         | 24/1000 [00:00<00:25, 38.86it/s]/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer_avg/src/data/cancer_sim/cancer_simulation.py:734: RuntimeWarning: invalid value encountered in log
  (1 + rho * np.log(K / (counterfactual_cancer_volume[current_t] + 1e-07) + 1e-07) -
  3%|â–Ž         | 29/1000 [00:00<00:23, 41.99it/s]  3%|â–Ž         | 34/1000 [00:00<00:23, 40.92it/s]  4%|â–         | 39/1000 [00:00<00:23, 40.26it/s]  4%|â–         | 44/1000 [00:01<00:24, 39.80it/s]  5%|â–         | 48/1000 [00:01<00:24, 39.63it/s]  5%|â–Œ         | 52/1000 [00:01<00:24, 39.46it/s]  6%|â–Œ         | 56/1000 [00:01<00:24, 39.33it/s]  6%|â–Œ         | 60/1000 [00:01<00:23, 39.20it/s]  6%|â–‹         | 64/1000 [00:01<00:23, 39.15it/s]  7%|â–‹         | 68/1000 [00:01<00:23, 39.13it/s]  7%|â–‹         | 73/1000 [00:01<00:22, 41.83it/s]  8%|â–Š         | 78/1000 [00:01<00:22, 40.85it/s]  8%|â–Š         | 83/1000 [00:02<00:22, 40.29it/s]  9%|â–‰         | 88/1000 [00:02<00:22, 39.90it/s]  9%|â–‰         | 93/1000 [00:02<00:22, 39.62it/s] 10%|â–‰         | 98/1000 [00:02<00:21, 41.77it/s] 10%|â–ˆ         | 103/1000 [00:02<00:21, 40.98it/s] 11%|â–ˆ         | 108/1000 [00:02<00:22, 40.33it/s] 11%|â–ˆâ–        | 113/1000 [00:02<00:22, 39.92it/s] 12%|â–ˆâ–        | 118/1000 [00:02<00:22, 39.66it/s] 12%|â–ˆâ–        | 124/1000 [00:03<00:20, 43.51it/s] 13%|â–ˆâ–Ž        | 129/1000 [00:03<00:20, 42.05it/s] 13%|â–ˆâ–Ž        | 134/1000 [00:03<00:21, 41.10it/s] 14%|â–ˆâ–        | 139/1000 [00:03<00:21, 40.41it/s] 14%|â–ˆâ–        | 144/1000 [00:03<00:21, 39.94it/s] 15%|â–ˆâ–        | 149/1000 [00:03<00:21, 39.58it/s] 15%|â–ˆâ–Œ        | 153/1000 [00:03<00:21, 39.41it/s] 16%|â–ˆâ–Œ        | 157/1000 [00:03<00:21, 39.26it/s] 16%|â–ˆâ–Œ        | 162/1000 [00:04<00:20, 41.75it/s] 17%|â–ˆâ–‹        | 167/1000 [00:04<00:20, 40.83it/s] 17%|â–ˆâ–‹        | 172/1000 [00:04<00:20, 40.22it/s] 18%|â–ˆâ–Š        | 177/1000 [00:04<00:19, 41.99it/s] 18%|â–ˆâ–Š        | 182/1000 [00:04<00:19, 41.02it/s] 19%|â–ˆâ–Š        | 187/1000 [00:04<00:19, 42.40it/s] 19%|â–ˆâ–‰        | 192/1000 [00:04<00:19, 41.30it/s] 20%|â–ˆâ–‰        | 197/1000 [00:04<00:19, 40.55it/s] 20%|â–ˆâ–ˆ        | 202/1000 [00:05<00:19, 40.08it/s] 21%|â–ˆâ–ˆ        | 207/1000 [00:05<00:18, 41.86it/s] 21%|â–ˆâ–ˆ        | 212/1000 [00:05<00:19, 40.91it/s] 22%|â–ˆâ–ˆâ–       | 217/1000 [00:05<00:19, 40.32it/s] 22%|â–ˆâ–ˆâ–       | 222/1000 [00:05<00:19, 39.90it/s] 23%|â–ˆâ–ˆâ–Ž       | 227/1000 [00:05<00:19, 39.58it/s] 23%|â–ˆâ–ˆâ–Ž       | 231/1000 [00:05<00:19, 39.43it/s] 24%|â–ˆâ–ˆâ–Ž       | 235/1000 [00:05<00:19, 39.30it/s] 24%|â–ˆâ–ˆâ–       | 239/1000 [00:05<00:19, 39.22it/s] 24%|â–ˆâ–ˆâ–       | 243/1000 [00:06<00:19, 39.16it/s] 25%|â–ˆâ–ˆâ–       | 247/1000 [00:06<00:19, 39.08it/s] 25%|â–ˆâ–ˆâ–Œ       | 251/1000 [00:06<00:19, 39.05it/s] 26%|â–ˆâ–ˆâ–Œ       | 255/1000 [00:06<00:19, 39.01it/s] 26%|â–ˆâ–ˆâ–Œ       | 259/1000 [00:06<00:19, 38.97it/s] 26%|â–ˆâ–ˆâ–‹       | 263/1000 [00:06<00:18, 38.93it/s] 27%|â–ˆâ–ˆâ–‹       | 267/1000 [00:06<00:18, 38.79it/s] 27%|â–ˆâ–ˆâ–‹       | 271/1000 [00:06<00:18, 38.83it/s] 28%|â–ˆâ–ˆâ–Š       | 275/1000 [00:06<00:18, 38.82it/s] 28%|â–ˆâ–ˆâ–Š       | 279/1000 [00:06<00:18, 38.86it/s] 28%|â–ˆâ–ˆâ–Š       | 283/1000 [00:07<00:18, 38.89it/s] 29%|â–ˆâ–ˆâ–Š       | 287/1000 [00:07<00:18, 38.87it/s] 29%|â–ˆâ–ˆâ–‰       | 291/1000 [00:07<00:18, 38.87it/s] 30%|â–ˆâ–ˆâ–‰       | 295/1000 [00:07<00:18, 38.83it/s] 30%|â–ˆâ–ˆâ–‰       | 299/1000 [00:07<00:18, 38.87it/s] 30%|â–ˆâ–ˆâ–ˆ       | 304/1000 [00:07<00:16, 41.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 309/1000 [00:07<00:16, 40.66it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 314/1000 [00:07<00:17, 40.06it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 319/1000 [00:07<00:17, 39.73it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 323/1000 [00:08<00:17, 39.51it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 327/1000 [00:08<00:17, 39.34it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 331/1000 [00:08<00:17, 39.21it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 335/1000 [00:08<00:16, 39.12it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 339/1000 [00:08<00:16, 39.05it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 343/1000 [00:08<00:16, 38.95it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 347/1000 [00:08<00:16, 38.93it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 352/1000 [00:08<00:15, 41.67it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 357/1000 [00:08<00:14, 43.67it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 362/1000 [00:08<00:14, 45.10it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 367/1000 [00:09<00:14, 42.94it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 372/1000 [00:09<00:15, 41.59it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 377/1000 [00:09<00:15, 40.73it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 382/1000 [00:09<00:14, 41.30it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 387/1000 [00:09<00:15, 40.54it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 392/1000 [00:09<00:15, 40.03it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 397/1000 [00:09<00:15, 39.72it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 401/1000 [00:09<00:15, 39.54it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 405/1000 [00:10<00:15, 39.20it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 409/1000 [00:10<00:15, 39.12it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 414/1000 [00:10<00:14, 41.57it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 419/1000 [00:10<00:14, 40.69it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 424/1000 [00:10<00:14, 40.11it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 429/1000 [00:10<00:14, 39.75it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 433/1000 [00:10<00:14, 39.56it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 437/1000 [00:10<00:14, 39.41it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 441/1000 [00:10<00:14, 39.25it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 445/1000 [00:11<00:14, 39.15it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 450/1000 [00:11<00:13, 41.80it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 455/1000 [00:11<00:12, 43.67it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 460/1000 [00:11<00:12, 42.02it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 465/1000 [00:11<00:12, 41.26it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 470/1000 [00:11<00:13, 40.51it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 475/1000 [00:11<00:12, 41.91it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 480/1000 [00:11<00:12, 41.20it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 485/1000 [00:12<00:12, 40.49it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 490/1000 [00:12<00:12, 40.01it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 495/1000 [00:12<00:12, 39.67it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 499/1000 [00:12<00:12, 39.47it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 503/1000 [00:12<00:12, 39.36it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 507/1000 [00:12<00:12, 39.22it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 511/1000 [00:12<00:12, 39.14it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 515/1000 [00:12<00:12, 39.07it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 519/1000 [00:12<00:12, 39.04it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 523/1000 [00:13<00:12, 39.29it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 527/1000 [00:13<00:12, 39.15it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 531/1000 [00:13<00:12, 39.06it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 535/1000 [00:13<00:11, 38.98it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 539/1000 [00:13<00:11, 38.91it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 543/1000 [00:13<00:11, 38.85it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 547/1000 [00:13<00:11, 38.85it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 551/1000 [00:13<00:11, 38.83it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 555/1000 [00:13<00:11, 38.84it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 559/1000 [00:13<00:11, 38.83it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 563/1000 [00:14<00:11, 38.84it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 568/1000 [00:14<00:10, 41.46it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 573/1000 [00:14<00:10, 40.56it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 578/1000 [00:14<00:10, 40.02it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 583/1000 [00:14<00:10, 39.68it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 587/1000 [00:14<00:10, 39.43it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 591/1000 [00:14<00:10, 39.25it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 595/1000 [00:14<00:10, 39.17it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 599/1000 [00:14<00:10, 38.78it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 603/1000 [00:15<00:10, 38.80it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 607/1000 [00:15<00:10, 38.81it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 611/1000 [00:15<00:10, 38.88it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 616/1000 [00:15<00:09, 41.59it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 621/1000 [00:15<00:09, 40.65it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 626/1000 [00:15<00:10, 36.34it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 630/1000 [00:15<00:10, 35.54it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 634/1000 [00:15<00:10, 36.41it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 638/1000 [00:15<00:09, 37.09it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 642/1000 [00:16<00:09, 37.56it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 647/1000 [00:16<00:08, 40.55it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 652/1000 [00:16<00:08, 42.81it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 657/1000 [00:16<00:08, 41.52it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 662/1000 [00:16<00:08, 40.61it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 667/1000 [00:16<00:08, 40.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 672/1000 [00:16<00:08, 39.68it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 676/1000 [00:16<00:08, 39.48it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 680/1000 [00:17<00:08, 39.32it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 684/1000 [00:17<00:08, 39.20it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 688/1000 [00:17<00:07, 39.13it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 692/1000 [00:17<00:07, 39.05it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 696/1000 [00:17<00:07, 39.00it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 700/1000 [00:17<00:07, 38.96it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 704/1000 [00:17<00:07, 38.97it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 708/1000 [00:17<00:07, 38.93it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 713/1000 [00:17<00:07, 39.26it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 717/1000 [00:17<00:07, 39.19it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 721/1000 [00:18<00:07, 39.13it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 725/1000 [00:18<00:07, 39.06it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 729/1000 [00:18<00:06, 39.02it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 733/1000 [00:18<00:06, 38.98it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 737/1000 [00:18<00:06, 38.96it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 741/1000 [00:18<00:06, 38.92it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 745/1000 [00:18<00:06, 38.91it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 749/1000 [00:18<00:06, 38.88it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 754/1000 [00:18<00:05, 41.76it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 759/1000 [00:19<00:05, 40.78it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 764/1000 [00:19<00:05, 39.88it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 769/1000 [00:19<00:05, 39.43it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 773/1000 [00:19<00:05, 39.47it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 777/1000 [00:19<00:05, 39.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 781/1000 [00:19<00:05, 39.17it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 785/1000 [00:19<00:05, 39.08it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 789/1000 [00:19<00:05, 38.65it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 793/1000 [00:19<00:05, 38.68it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 798/1000 [00:20<00:05, 40.07it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 802/1000 [00:20<00:04, 39.73it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 806/1000 [00:20<00:05, 38.69it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 811/1000 [00:20<00:04, 40.87it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 816/1000 [00:20<00:04, 37.54it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 820/1000 [00:20<00:04, 37.72it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 824/1000 [00:20<00:04, 38.04it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 828/1000 [00:20<00:04, 38.28it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 832/1000 [00:20<00:04, 38.44it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 836/1000 [00:21<00:04, 38.52it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 840/1000 [00:21<00:04, 38.57it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 844/1000 [00:21<00:04, 38.65it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 848/1000 [00:21<00:03, 38.73it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 852/1000 [00:21<00:03, 38.97it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 856/1000 [00:21<00:03, 38.94it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 860/1000 [00:21<00:03, 38.91it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 864/1000 [00:21<00:03, 38.11it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 868/1000 [00:21<00:03, 38.31it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 872/1000 [00:21<00:03, 38.46it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 876/1000 [00:22<00:03, 38.58it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 880/1000 [00:22<00:03, 38.70it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 884/1000 [00:22<00:02, 38.75it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 889/1000 [00:22<00:02, 40.61it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 894/1000 [00:22<00:02, 40.03it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 899/1000 [00:22<00:02, 39.64it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 903/1000 [00:22<00:02, 39.46it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 907/1000 [00:22<00:02, 39.58it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 911/1000 [00:22<00:02, 39.39it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 915/1000 [00:23<00:02, 39.28it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 919/1000 [00:23<00:02, 39.20it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 923/1000 [00:23<00:01, 39.10it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 927/1000 [00:23<00:01, 39.02it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 932/1000 [00:23<00:01, 41.80it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 937/1000 [00:23<00:01, 40.79it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 942/1000 [00:23<00:01, 40.16it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 947/1000 [00:23<00:01, 40.61it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 952/1000 [00:23<00:01, 40.06it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 957/1000 [00:24<00:01, 40.55it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 962/1000 [00:24<00:00, 39.96it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 967/1000 [00:24<00:00, 39.59it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 971/1000 [00:24<00:00, 39.39it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 975/1000 [00:24<00:00, 39.26it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 979/1000 [00:24<00:00, 38.79it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 983/1000 [00:24<00:00, 38.78it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 988/1000 [00:24<00:00, 40.61it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 993/1000 [00:24<00:00, 42.83it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 998/1000 [00:25<00:00, 41.53it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:25<00:00, 39.77it/s][[36m2024-09-27 07:02:13,901[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - train Dataset already processed[0m
[[36m2024-09-27 07:02:13,901[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Processing val dataset before training[0m
[[36m2024-09-27 07:02:13,998[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Shape of processed val data: {'cancer_volume': (1000, 60), 'chemo_dosage': (1000, 60), 'radio_dosage': (1000, 60), 'chemo_application': (1000, 60), 'radio_application': (1000, 60), 'chemo_probabilities': (1000, 60), 'radio_probabilities': (1000, 60), 'sequence_lengths': (1000,), 'death_flags': (1000, 60), 'recovery_flags': (1000, 60), 'patient_types': (1000,), 'prev_treatments': (1000, 59, 4), 'current_treatments': (1000, 59, 4), 'current_covariates': (1000, 59, 2), 'outputs': (1000, 59, 1), 'active_entries': (1000, 59, 1), 'unscaled_outputs': (1000, 59, 1), 'prev_outputs': (1000, 59, 1), 'static_features': (1000, 1)}[0m
[[36m2024-09-27 07:02:13,998[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Processing test dataset before training[0m
[[36m2024-09-27 07:02:33,940[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Shape of processed test data: {'cancer_volume': (222916, 60), 'chemo_application': (222916, 60), 'radio_application': (222916, 60), 'sequence_lengths': (222916,), 'patient_types': (222916,), 'prev_treatments': (222916, 59, 4), 'current_treatments': (222916, 59, 4), 'current_covariates': (222916, 59, 2), 'outputs': (222916, 59, 1), 'active_entries': (222916, 59, 1), 'unscaled_outputs': (222916, 59, 1), 'prev_outputs': (222916, 59, 1), 'static_features': (222916, 1)}[0m
[[36m2024-09-27 07:02:34,209[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f07106ae790>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m
[[36m2024-09-27 07:02:38,785[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f07106ae910>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m
[[36m2024-09-27 07:02:47,223[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f07106aebe0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m
[[36m2024-09-27 07:03:03,819[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f07106aefd0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m
[[36m2024-09-27 07:03:36,058[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=0, connect=0, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0701bc91c0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m

Error executing job with overrides: ['+dataset=cancer_sim', '+backbone=crn', "+backbone/crn_hparams/cancer_sim_subgroup_random='3'", 'exp.seed=10']
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connection.py", line 196, in _new_conn
    sock = connection.create_connection(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 495, in _make_request
    conn.request(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connection.py", line 398, in request
    self.endheaders()
  File "/usr/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connection.py", line 236, in connect
    self.sock = self._new_conn()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connection.py", line 211, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f0701bc9f70>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 873, in urlopen
    return self.urlopen(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 873, in urlopen
    return self.urlopen(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 873, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0701bc9f70>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 187, in http_request
    return _get_http_response_with_retries(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/request_utils.py", line 237, in _get_http_response_with_retries
    return session.request(method, url, allow_redirects=allow_redirects, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0701bc9f70>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "runnables/train_enc_dec.py", line 54, in main
    artifacts_path = hydra.utils.to_absolute_path(mlf_logger.experiment.get_run(mlf_logger.run_id).info.artifact_uri)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/loggers/base.py", line 42, in experiment
    return get_experiment() or DummyExperiment()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py", line 48, in wrapped_fn
    return fn(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/loggers/base.py", line 40, in get_experiment
    return fn(self)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/loggers/mlflow.py", line 152, in experiment
    expt = self._mlflow_client.get_experiment_by_name(self._experiment_name)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/tracking/client.py", line 1240, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 484, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 518, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 81, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 357, in call_endpoint
    response = http_request(**call_kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 210, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://127.0.0.1:5000/api/2.0/mlflow/experiments/get-by-name failed with exception HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0701bc9f70>: Failed to establish a new connection: [Errno 111] Connection refused'))

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
/var/spool/slurmd/job13718/slurm_script: line 20: exp.mlflow_uri=http://127.0.0.1:8099: No such file or directory
