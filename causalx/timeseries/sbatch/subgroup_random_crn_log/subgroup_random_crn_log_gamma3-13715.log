[2024-09-27 04:52:07 +0000] [1852873] [INFO] Starting gunicorn 22.0.0
[2024-09-27 04:52:07 +0000] [1852873] [INFO] Listening at: http://127.0.0.1:8003 (1852873)
[2024-09-27 04:52:07 +0000] [1852873] [INFO] Using worker: sync
[2024-09-27 04:52:07 +0000] [1852876] [INFO] Booting worker with pid: 1852876
[2024-09-27 04:52:07 +0000] [1852877] [INFO] Booting worker with pid: 1852877
[2024-09-27 04:52:07 +0000] [1852878] [INFO] Booting worker with pid: 1852878
[2024-09-27 04:52:07 +0000] [1852879] [INFO] Booting worker with pid: 1852879
runnables/train_enc_dec.py:18: UserWarning: 
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
  @hydra.main(config_name=f'config.yaml', config_path='../config/')
[[36m2024-09-27 04:52:22,075[0m][[34m__main__[0m][[32mINFO[0m] - 
model:
  dim_treatments: 4
  dim_vitals: 0
  dim_static_features: 1
  dim_outcomes: 1
  name: CRN
  encoder:
    _target_: src.models.crn.CRNEncoder
    seq_hidden_units: 24
    br_size: 24
    fc_hidden_units: 96
    dropout_rate: 0.2
    num_layer: 1
    batch_size: 1024
    optimizer:
      optimizer_cls: adam
      learning_rate: 0.005
      weight_decay: 0.0
      lr_scheduler: false
    tune_hparams: false
    tune_range: 50
    hparams_grid: null
    resources_per_trial: null
  train_decoder: true
  decoder:
    _target_: src.models.crn.CRNDecoder
    seq_hidden_units: null
    br_size: 18
    fc_hidden_units: 9
    dropout_rate: 0.1
    num_layer: 1
    batch_size: 4096
    optimizer:
      optimizer_cls: adam
      learning_rate: 0.01
      weight_decay: 0.0
      lr_scheduler: false
    tune_hparams: false
    tune_range: 30
    hparams_grid: null
    resources_per_trial: null
dataset:
  val_batch_size: 512
  treatment_mode: multiclass
  _target_: src.data.SyntheticCancerDatasetCollection
  name: tumor_generator
  coeff: 3.0
  chemo_coeff: 3.0
  radio_coeff: 3.0
  seed: 10
  random: true
  num_patients:
    train: 10000
    val: 1000
    test: 1000
  window_size: 15
  lag: 0
  max_seq_length: 60
  projection_horizon: 5
  cf_seq_mode: sliding_treatment
exp:
  seed: 10
  gpus:
  - 0
  max_epochs: 200
  logging: true
  mlflow_uri: http://127.0.0.1:5000
  unscale_rmse: true
  percentage_rmse: true
  alpha: 0
  update_alpha: true
  alpha_rate: exp
  balancing: subgroup
  bce_weight: false
  weights_ema: true
  beta: 0.99
  alpha_wass: 0.001
  alpha_wass_epoch: false
  alpha_wass_growth: 0.001
  alpha_wass_max: 0.01
  num_timepoints: 59
[0m
/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/hydra/_internal/hydra.py:119: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/1.2/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  ret = run_job(
Global seed set to 10
[[36m2024-09-27 04:52:22,117[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-27 04:52:22,121[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-27 04:52:22,122[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-27 04:52:22,123[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-27 04:52:22,125[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-27 04:52:22,153[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 4658 patients[0m
[[36m2024-09-27 04:52:22,158[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 9338 patients[0m
[[36m2024-09-27 04:52:22,162[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 13912 patients[0m
[[36m2024-09-27 04:52:22,170[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-27 04:52:22,175[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m
  0%|          | 0/10000 [00:00<?, ?it/s]/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer_avg/src/data/cancer_sim/cancer_simulation.py:346: RuntimeWarning: overflow encountered in exp
  if recovery_rvs[i, t] < np.exp(-cancer_volume[i, t] * TUMOUR_CELL_DENSITY):
  1%|          | 65/10000 [00:00<00:15, 641.58it/s]  1%|â–         | 133/10000 [00:00<00:14, 658.60it/s]  2%|â–         | 199/10000 [00:00<00:15, 647.05it/s]  3%|â–Ž         | 266/10000 [00:00<00:14, 652.23it/s]  3%|â–Ž         | 332/10000 [00:00<00:14, 651.57it/s]  4%|â–         | 399/10000 [00:00<00:14, 655.84it/s]  5%|â–         | 467/10000 [00:00<00:14, 663.63it/s]  5%|â–Œ         | 534/10000 [00:00<00:14, 659.92it/s]  6%|â–Œ         | 601/10000 [00:00<00:14, 656.74it/s]  7%|â–‹         | 667/10000 [00:01<00:14, 654.55it/s]  7%|â–‹         | 733/10000 [00:01<00:14, 654.53it/s]  8%|â–Š         | 799/10000 [00:01<00:14, 650.16it/s]  9%|â–Š         | 865/10000 [00:01<00:14, 648.43it/s]  9%|â–‰         | 931/10000 [00:01<00:13, 650.31it/s] 10%|â–‰         | 997/10000 [00:01<00:13, 648.43it/s] 11%|â–ˆ         | 1065/10000 [00:01<00:13, 655.96it/s] 11%|â–ˆâ–        | 1131/10000 [00:01<00:13, 655.68it/s] 12%|â–ˆâ–        | 1198/10000 [00:01<00:13, 658.11it/s] 13%|â–ˆâ–Ž        | 1264/10000 [00:01<00:13, 653.38it/s] 13%|â–ˆâ–Ž        | 1330/10000 [00:02<00:13, 650.42it/s] 14%|â–ˆâ–        | 1396/10000 [00:02<00:13, 646.02it/s] 15%|â–ˆâ–        | 1461/10000 [00:02<00:13, 643.87it/s] 15%|â–ˆâ–Œ        | 1529/10000 [00:02<00:12, 653.00it/s] 16%|â–ˆâ–Œ        | 1598/10000 [00:02<00:12, 661.94it/s] 17%|â–ˆâ–‹        | 1665/10000 [00:02<00:12, 656.44it/s] 17%|â–ˆâ–‹        | 1731/10000 [00:02<00:12, 652.27it/s] 18%|â–ˆâ–Š        | 1802/10000 [00:02<00:12, 667.52it/s] 19%|â–ˆâ–Š        | 1869/10000 [00:02<00:12, 664.60it/s] 19%|â–ˆâ–‰        | 1936/10000 [00:02<00:12, 658.96it/s] 20%|â–ˆâ–ˆ        | 2003/10000 [00:03<00:12, 660.52it/s] 21%|â–ˆâ–ˆ        | 2070/10000 [00:03<00:12, 623.27it/s] 21%|â–ˆâ–ˆâ–       | 2136/10000 [00:03<00:12, 630.89it/s] 22%|â–ˆâ–ˆâ–       | 2203/10000 [00:03<00:12, 641.26it/s] 23%|â–ˆâ–ˆâ–Ž       | 2268/10000 [00:03<00:12, 640.02it/s] 23%|â–ˆâ–ˆâ–Ž       | 2333/10000 [00:03<00:11, 641.04it/s] 24%|â–ˆâ–ˆâ–       | 2399/10000 [00:03<00:11, 643.68it/s] 25%|â–ˆâ–ˆâ–       | 2467/10000 [00:03<00:11, 654.28it/s] 25%|â–ˆâ–ˆâ–Œ       | 2533/10000 [00:03<00:11, 655.09it/s] 26%|â–ˆâ–ˆâ–Œ       | 2599/10000 [00:03<00:11, 649.89it/s] 27%|â–ˆâ–ˆâ–‹       | 2667/10000 [00:04<00:11, 658.25it/s] 27%|â–ˆâ–ˆâ–‹       | 2736/10000 [00:04<00:10, 665.45it/s] 28%|â–ˆâ–ˆâ–Š       | 2803/10000 [00:04<00:10, 656.90it/s] 29%|â–ˆâ–ˆâ–Š       | 2872/10000 [00:04<00:10, 664.34it/s] 29%|â–ˆâ–ˆâ–‰       | 2939/10000 [00:04<00:10, 659.70it/s] 30%|â–ˆâ–ˆâ–ˆ       | 3006/10000 [00:04<00:10, 659.90it/s] 31%|â–ˆâ–ˆâ–ˆ       | 3073/10000 [00:04<00:10, 654.94it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 3139/10000 [00:04<00:10, 654.77it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 3205/10000 [00:04<00:10, 651.42it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3273/10000 [00:05<00:10, 657.45it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3339/10000 [00:05<00:10, 657.48it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 3405/10000 [00:05<00:10, 656.38it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 3471/10000 [00:05<00:10, 651.35it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 3537/10000 [00:05<00:10, 644.62it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 3605/10000 [00:05<00:09, 654.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 3672/10000 [00:05<00:09, 656.94it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 3738/10000 [00:05<00:09, 647.46it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 3804/10000 [00:05<00:09, 649.57it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 3872/10000 [00:05<00:09, 656.96it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 3938/10000 [00:06<00:09, 654.13it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4004/10000 [00:06<00:09, 650.88it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4070/10000 [00:06<00:09, 644.84it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4135/10000 [00:06<00:09, 645.59it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4200/10000 [00:06<00:08, 646.30it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 4265/10000 [00:06<00:08, 644.76it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 4330/10000 [00:06<00:08, 646.21it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4395/10000 [00:06<00:08, 644.64it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4460/10000 [00:06<00:08, 646.08it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 4526/10000 [00:06<00:08, 649.44it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 4591/10000 [00:07<00:08, 644.75it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 4656/10000 [00:07<00:08, 641.87it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 4721/10000 [00:07<00:08, 643.92it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 4786/10000 [00:07<00:08, 638.16it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 4850/10000 [00:07<00:08, 600.60it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 4911/10000 [00:07<00:08, 583.08it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 4975/10000 [00:07<00:08, 597.66it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5040/10000 [00:07<00:08, 611.08it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5107/10000 [00:07<00:07, 626.78it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5172/10000 [00:07<00:07, 633.27it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5241/10000 [00:08<00:07, 647.44it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 5306/10000 [00:08<00:07, 647.44it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 5372/10000 [00:08<00:07, 650.18it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5441/10000 [00:08<00:06, 660.08it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5509/10000 [00:08<00:06, 665.08it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5576/10000 [00:08<00:06, 662.75it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 5643/10000 [00:08<00:06, 663.70it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 5711/10000 [00:08<00:06, 665.46it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 5778/10000 [00:08<00:06, 664.59it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 5845/10000 [00:08<00:06, 664.47it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 5912/10000 [00:09<00:06, 660.67it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 5979/10000 [00:09<00:06, 650.00it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6045/10000 [00:09<00:06, 645.23it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6112/10000 [00:09<00:05, 650.32it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6178/10000 [00:09<00:05, 649.88it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6245/10000 [00:09<00:05, 655.33it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 6311/10000 [00:09<00:05, 651.23it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6380/10000 [00:09<00:05, 661.37it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6447/10000 [00:09<00:05, 655.86it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 6513/10000 [00:10<00:05, 652.34it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 6579/10000 [00:10<00:05, 653.11it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6645/10000 [00:10<00:05, 647.90it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6711/10000 [00:10<00:05, 649.24it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 6779/10000 [00:10<00:04, 656.79it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 6845/10000 [00:10<00:04, 652.48it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 6911/10000 [00:10<00:04, 652.62it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 6977/10000 [00:10<00:04, 652.95it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7043/10000 [00:10<00:04, 651.91it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7113/10000 [00:10<00:04, 663.64it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7180/10000 [00:11<00:04, 662.14it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7247/10000 [00:11<00:04, 662.89it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 7314/10000 [00:11<00:04, 659.89it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7382/10000 [00:11<00:03, 663.26it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7450/10000 [00:11<00:03, 666.02it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 7517/10000 [00:11<00:03, 659.13it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 7585/10000 [00:11<00:03, 662.78it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 7652/10000 [00:11<00:03, 656.87it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 7718/10000 [00:11<00:03, 654.71it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7784/10000 [00:11<00:03, 651.69it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7853/10000 [00:12<00:03, 662.71it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 7920/10000 [00:12<00:03, 663.40it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 7987/10000 [00:12<00:03, 657.55it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8053/10000 [00:12<00:02, 653.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8119/10000 [00:12<00:02, 648.06it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8185/10000 [00:12<00:02, 649.91it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 8251/10000 [00:12<00:02, 649.76it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 8317/10000 [00:12<00:02, 650.05it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8383/10000 [00:12<00:02, 645.37it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8448/10000 [00:12<00:02, 645.25it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 8513/10000 [00:13<00:02, 644.70it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 8578/10000 [00:13<00:02, 641.35it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 8647/10000 [00:13<00:02, 654.79it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 8713/10000 [00:13<00:01, 652.29it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 8779/10000 [00:13<00:01, 649.67it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 8844/10000 [00:13<00:01, 648.81it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8910/10000 [00:13<00:01, 651.55it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8976/10000 [00:13<00:01, 650.07it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9042/10000 [00:13<00:01, 644.95it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9111/10000 [00:13<00:01, 657.88it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9177/10000 [00:14<00:01, 653.82it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9243/10000 [00:14<00:01, 654.41it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 9311/10000 [00:14<00:01, 659.40it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9378/10000 [00:14<00:00, 660.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9445/10000 [00:14<00:00, 654.88it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 9511/10000 [00:14<00:00, 655.97it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 9577/10000 [00:14<00:00, 655.92it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 9643/10000 [00:14<00:00, 651.41it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 9709/10000 [00:14<00:00, 649.03it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 9774/10000 [00:15<00:00, 648.64it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 9839/10000 [00:15<00:00, 644.68it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 9904/10000 [00:15<00:00, 644.33it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 9971/10000 [00:15<00:00, 650.74it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10000/10000 [00:15<00:00, 651.05it/s]Modified current_covariates:
[[36m2024-09-27 04:52:37,851[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Processing train dataset before training[0m
[[36m2024-09-27 04:52:38,794[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Shape of processed train data: {'cancer_volume': (10000, 60), 'chemo_dosage': (10000, 60), 'radio_dosage': (10000, 60), 'chemo_application': (10000, 60), 'radio_application': (10000, 60), 'chemo_probabilities': (10000, 60), 'radio_probabilities': (10000, 60), 'sequence_lengths': (10000,), 'death_flags': (10000, 60), 'recovery_flags': (10000, 60), 'patient_types': (10000,), 'prev_treatments': (10000, 59, 4), 'current_treatments': (10000, 59, 4), 'current_covariates': (10000, 59, 2), 'outputs': (10000, 59, 1), 'active_entries': (10000, 59, 1), 'unscaled_outputs': (10000, 59, 1), 'prev_outputs': (10000, 59, 1), 'static_features': (10000, 1)}[0m
before change [-0.10472591 -1.23120471]
after change [-0.03583885  0.09391788]
before change [-0.14468863 -1.23120471]
after change [-0.14391977  0.22986788]
[[36m2024-09-27 04:52:38,849[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-27 04:52:38,850[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-27 04:52:38,851[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-27 04:52:38,852[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-27 04:52:38,852[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-27 04:52:38,854[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 455 patients[0m
[[36m2024-09-27 04:52:38,855[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 905 patients[0m
[[36m2024-09-27 04:52:38,856[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 1366 patients[0m
[[36m2024-09-27 04:52:38,858[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-27 04:52:38,858[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m

  0%|          | 0/1000 [00:00<?, ?it/s]/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer_avg/src/data/cancer_sim/cancer_simulation.py:346: RuntimeWarning: overflow encountered in exp
  if recovery_rvs[i, t] < np.exp(-cancer_volume[i, t] * TUMOUR_CELL_DENSITY):
  6%|â–‹         | 65/1000 [00:00<00:01, 644.33it/s] 13%|â–ˆâ–Ž        | 130/1000 [00:00<00:01, 643.01it/s] 20%|â–ˆâ–‰        | 195/1000 [00:00<00:01, 635.17it/s] 26%|â–ˆâ–ˆâ–Œ       | 261/1000 [00:00<00:01, 640.93it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 326/1000 [00:00<00:01, 637.24it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 392/1000 [00:00<00:00, 642.13it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 458/1000 [00:00<00:00, 645.52it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 524/1000 [00:00<00:00, 647.41it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 590/1000 [00:00<00:00, 648.33it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 656/1000 [00:01<00:00, 650.01it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 724/1000 [00:01<00:00, 656.13it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 790/1000 [00:01<00:00, 649.59it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 855/1000 [00:01<00:00, 648.58it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 921/1000 [00:01<00:00, 649.44it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 987/1000 [00:01<00:00, 650.20it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:01<00:00, 646.87it/s][[36m2024-09-27 04:52:40,410[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-27 04:52:40,410[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-27 04:52:40,411[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-27 04:52:40,411[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-27 04:52:40,412[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-27 04:52:40,414[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 493 patients[0m
[[36m2024-09-27 04:52:40,415[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 947 patients[0m
[[36m2024-09-27 04:52:40,416[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 1403 patients[0m
[[36m2024-09-27 04:52:40,417[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-27 04:52:40,418[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m

  0%|          | 0/1000 [00:00<?, ?it/s]  1%|â–         | 14/1000 [00:00<00:07, 130.30it/s]  3%|â–Ž         | 28/1000 [00:00<00:07, 132.61it/s]  4%|â–         | 42/1000 [00:00<00:07, 132.49it/s]  6%|â–Œ         | 56/1000 [00:00<00:07, 132.39it/s]  7%|â–‹         | 70/1000 [00:00<00:07, 132.20it/s]  8%|â–Š         | 84/1000 [00:00<00:06, 132.22it/s] 10%|â–‰         | 99/1000 [00:00<00:06, 136.55it/s] 11%|â–ˆâ–        | 113/1000 [00:00<00:06, 135.16it/s] 13%|â–ˆâ–Ž        | 127/1000 [00:00<00:06, 134.26it/s] 14%|â–ˆâ–        | 142/1000 [00:01<00:06, 136.31it/s] 16%|â–ˆâ–Œ        | 156/1000 [00:01<00:06, 135.00it/s] 17%|â–ˆâ–‹        | 170/1000 [00:01<00:06, 134.05it/s] 18%|â–ˆâ–Š        | 184/1000 [00:01<00:06, 133.45it/s] 20%|â–ˆâ–‰        | 198/1000 [00:01<00:06, 133.04it/s] 21%|â–ˆâ–ˆ        | 212/1000 [00:01<00:05, 132.75it/s] 23%|â–ˆâ–ˆâ–Ž       | 227/1000 [00:01<00:05, 135.35it/s] 24%|â–ˆâ–ˆâ–       | 241/1000 [00:01<00:05, 134.34it/s] 26%|â–ˆâ–ˆâ–Œ       | 255/1000 [00:01<00:05, 133.70it/s] 27%|â–ˆâ–ˆâ–‹       | 270/1000 [00:02<00:05, 135.96it/s] 28%|â–ˆâ–ˆâ–Š       | 284/1000 [00:02<00:05, 136.63it/s] 30%|â–ˆâ–ˆâ–‰       | 298/1000 [00:02<00:05, 135.12it/s] 31%|â–ˆâ–ˆâ–ˆ       | 312/1000 [00:02<00:05, 134.10it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 328/1000 [00:02<00:04, 139.53it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 342/1000 [00:02<00:04, 139.51it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 357/1000 [00:02<00:04, 141.68it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 372/1000 [00:02<00:04, 138.58it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 386/1000 [00:02<00:04, 137.11it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 400/1000 [00:02<00:04, 135.52it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 414/1000 [00:03<00:04, 136.42it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 430/1000 [00:03<00:04, 141.61it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 446/1000 [00:03<00:03, 146.08it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 461/1000 [00:03<00:03, 144.36it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 476/1000 [00:03<00:03, 141.67it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 491/1000 [00:03<00:03, 141.50it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 506/1000 [00:03<00:03, 141.33it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 521/1000 [00:03<00:03, 142.31it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 537/1000 [00:03<00:03, 144.84it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 552/1000 [00:04<00:03, 143.66it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 567/1000 [00:04<00:03, 142.46it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 585/1000 [00:04<00:02, 151.51it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 602/1000 [00:04<00:02, 156.37it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 619/1000 [00:04<00:02, 159.13it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 636/1000 [00:04<00:02, 160.56it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 654/1000 [00:04<00:02, 164.76it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 671/1000 [00:04<00:02, 162.71it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 688/1000 [00:04<00:01, 163.97it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 705/1000 [00:04<00:01, 158.98it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 721/1000 [00:05<00:01, 153.83it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 737/1000 [00:05<00:01, 146.75it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 752/1000 [00:05<00:01, 145.03it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 767/1000 [00:05<00:01, 140.97it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 782/1000 [00:05<00:01, 143.15it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 797/1000 [00:05<00:01, 139.64it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 812/1000 [00:05<00:01, 137.31it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 826/1000 [00:05<00:01, 136.35it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 840/1000 [00:05<00:01, 135.03it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 854/1000 [00:06<00:01, 134.05it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 868/1000 [00:06<00:00, 133.42it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 882/1000 [00:06<00:00, 132.96it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 896/1000 [00:06<00:00, 132.64it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 910/1000 [00:06<00:00, 132.42it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 924/1000 [00:06<00:00, 132.21it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 938/1000 [00:06<00:00, 132.11it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 952/1000 [00:06<00:00, 132.06it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 966/1000 [00:06<00:00, 132.07it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 980/1000 [00:07<00:00, 132.31it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 994/1000 [00:07<00:00, 132.19it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:07<00:00, 139.63it/s]Call to simulate counterfactuals data
[[36m2024-09-27 04:52:47,582[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-27 04:52:47,584[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-27 04:52:47,584[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-27 04:52:47,585[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-27 04:52:47,586[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-27 04:52:47,587[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 445 patients[0m
[[36m2024-09-27 04:52:47,588[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 895 patients[0m
[[36m2024-09-27 04:52:47,589[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 1355 patients[0m
[[36m2024-09-27 04:52:47,590[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-27 04:52:47,591[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m

  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 4/1000 [00:00<00:27, 36.81it/s]  1%|          | 8/1000 [00:00<00:27, 36.74it/s]  1%|          | 12/1000 [00:00<00:26, 36.94it/s]  2%|â–         | 16/1000 [00:00<00:26, 36.95it/s]  2%|â–         | 20/1000 [00:00<00:26, 36.95it/s]  2%|â–         | 24/1000 [00:00<00:26, 36.99it/s]/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer_avg/src/data/cancer_sim/cancer_simulation.py:734: RuntimeWarning: invalid value encountered in log
  (1 + rho * np.log(K / (counterfactual_cancer_volume[current_t] + 1e-07) + 1e-07) -
  3%|â–Ž         | 29/1000 [00:00<00:24, 39.95it/s]  3%|â–Ž         | 33/1000 [00:00<00:24, 39.06it/s]  4%|â–Ž         | 37/1000 [00:00<00:25, 38.39it/s]  4%|â–         | 41/1000 [00:01<00:25, 37.96it/s]  4%|â–         | 45/1000 [00:01<00:25, 37.72it/s]  5%|â–         | 49/1000 [00:01<00:25, 37.54it/s]  5%|â–Œ         | 53/1000 [00:01<00:25, 37.37it/s]  6%|â–Œ         | 57/1000 [00:01<00:25, 37.24it/s]  6%|â–Œ         | 61/1000 [00:01<00:25, 37.19it/s]  6%|â–‹         | 65/1000 [00:01<00:25, 37.23it/s]  7%|â–‹         | 69/1000 [00:01<00:25, 37.18it/s]  7%|â–‹         | 74/1000 [00:01<00:23, 39.74it/s]  8%|â–Š         | 78/1000 [00:02<00:23, 38.93it/s]  8%|â–Š         | 82/1000 [00:02<00:23, 38.44it/s]  9%|â–Š         | 86/1000 [00:02<00:24, 38.05it/s]  9%|â–‰         | 90/1000 [00:02<00:24, 37.73it/s]  9%|â–‰         | 94/1000 [00:02<00:24, 37.50it/s] 10%|â–‰         | 99/1000 [00:02<00:22, 39.91it/s] 10%|â–ˆ         | 103/1000 [00:02<00:22, 39.11it/s] 11%|â–ˆ         | 107/1000 [00:02<00:23, 38.50it/s] 11%|â–ˆ         | 111/1000 [00:02<00:23, 38.07it/s] 12%|â–ˆâ–        | 115/1000 [00:03<00:23, 37.80it/s] 12%|â–ˆâ–        | 119/1000 [00:03<00:23, 37.61it/s] 12%|â–ˆâ–Ž        | 125/1000 [00:03<00:20, 41.83it/s] 13%|â–ˆâ–Ž        | 130/1000 [00:03<00:21, 40.24it/s] 14%|â–ˆâ–Ž        | 135/1000 [00:03<00:22, 39.18it/s] 14%|â–ˆâ–        | 139/1000 [00:03<00:22, 38.60it/s] 14%|â–ˆâ–        | 143/1000 [00:03<00:22, 38.19it/s] 15%|â–ˆâ–        | 147/1000 [00:03<00:22, 37.90it/s] 15%|â–ˆâ–Œ        | 151/1000 [00:03<00:22, 37.65it/s] 16%|â–ˆâ–Œ        | 155/1000 [00:04<00:22, 37.46it/s] 16%|â–ˆâ–Œ        | 159/1000 [00:04<00:22, 37.34it/s] 16%|â–ˆâ–‹        | 164/1000 [00:04<00:20, 39.90it/s] 17%|â–ˆâ–‹        | 168/1000 [00:04<00:21, 39.06it/s] 17%|â–ˆâ–‹        | 172/1000 [00:04<00:21, 38.44it/s] 18%|â–ˆâ–Š        | 177/1000 [00:04<00:20, 40.28it/s] 18%|â–ˆâ–Š        | 182/1000 [00:04<00:20, 39.16it/s] 19%|â–ˆâ–Š        | 187/1000 [00:04<00:20, 40.52it/s] 19%|â–ˆâ–‰        | 192/1000 [00:04<00:20, 39.36it/s] 20%|â–ˆâ–‰        | 196/1000 [00:05<00:20, 38.71it/s] 20%|â–ˆâ–ˆ        | 200/1000 [00:05<00:20, 38.24it/s] 20%|â–ˆâ–ˆ        | 205/1000 [00:05<00:19, 40.00it/s] 21%|â–ˆâ–ˆ        | 210/1000 [00:05<00:20, 39.03it/s] 21%|â–ˆâ–ˆâ–       | 214/1000 [00:05<00:20, 38.48it/s] 22%|â–ˆâ–ˆâ–       | 218/1000 [00:05<00:20, 38.08it/s] 22%|â–ˆâ–ˆâ–       | 222/1000 [00:05<00:20, 37.81it/s] 23%|â–ˆâ–ˆâ–Ž       | 226/1000 [00:05<00:20, 37.61it/s] 23%|â–ˆâ–ˆâ–Ž       | 230/1000 [00:05<00:20, 37.45it/s] 23%|â–ˆâ–ˆâ–Ž       | 234/1000 [00:06<00:20, 37.32it/s] 24%|â–ˆâ–ˆâ–       | 238/1000 [00:06<00:20, 37.26it/s] 24%|â–ˆâ–ˆâ–       | 242/1000 [00:06<00:20, 37.22it/s] 25%|â–ˆâ–ˆâ–       | 246/1000 [00:06<00:20, 37.17it/s] 25%|â–ˆâ–ˆâ–Œ       | 250/1000 [00:06<00:20, 37.13it/s] 25%|â–ˆâ–ˆâ–Œ       | 254/1000 [00:06<00:20, 37.13it/s] 26%|â–ˆâ–ˆâ–Œ       | 258/1000 [00:06<00:20, 37.10it/s] 26%|â–ˆâ–ˆâ–Œ       | 262/1000 [00:06<00:19, 37.10it/s] 27%|â–ˆâ–ˆâ–‹       | 266/1000 [00:06<00:19, 37.07it/s] 27%|â–ˆâ–ˆâ–‹       | 270/1000 [00:07<00:19, 37.05it/s] 27%|â–ˆâ–ˆâ–‹       | 274/1000 [00:07<00:19, 37.05it/s] 28%|â–ˆâ–ˆâ–Š       | 278/1000 [00:07<00:19, 37.07it/s] 28%|â–ˆâ–ˆâ–Š       | 282/1000 [00:07<00:19, 37.09it/s] 29%|â–ˆâ–ˆâ–Š       | 286/1000 [00:07<00:19, 37.08it/s] 29%|â–ˆâ–ˆâ–‰       | 290/1000 [00:07<00:19, 37.07it/s] 29%|â–ˆâ–ˆâ–‰       | 294/1000 [00:07<00:19, 37.09it/s] 30%|â–ˆâ–ˆâ–‰       | 298/1000 [00:07<00:18, 37.10it/s] 30%|â–ˆâ–ˆâ–ˆ       | 303/1000 [00:07<00:17, 39.70it/s] 31%|â–ˆâ–ˆâ–ˆ       | 307/1000 [00:08<00:17, 38.88it/s] 31%|â–ˆâ–ˆâ–ˆ       | 311/1000 [00:08<00:17, 38.35it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 315/1000 [00:08<00:18, 37.97it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 319/1000 [00:08<00:18, 37.70it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 323/1000 [00:08<00:18, 37.49it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 327/1000 [00:08<00:18, 37.38it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 331/1000 [00:08<00:17, 37.30it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 335/1000 [00:08<00:17, 37.22it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 339/1000 [00:08<00:17, 37.19it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 343/1000 [00:09<00:17, 37.14it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 347/1000 [00:09<00:17, 37.13it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 352/1000 [00:09<00:16, 39.80it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 356/1000 [00:09<00:16, 38.95it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 361/1000 [00:09<00:15, 41.11it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 366/1000 [00:09<00:14, 42.69it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 371/1000 [00:09<00:15, 40.72it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 376/1000 [00:09<00:15, 39.33it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 381/1000 [00:09<00:15, 39.68it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 385/1000 [00:10<00:15, 38.97it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 389/1000 [00:10<00:15, 38.41it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 393/1000 [00:10<00:15, 37.97it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 397/1000 [00:10<00:15, 37.70it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 401/1000 [00:10<00:15, 37.56it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 405/1000 [00:10<00:15, 37.42it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 409/1000 [00:10<00:15, 37.27it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 414/1000 [00:10<00:14, 39.69it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 418/1000 [00:10<00:14, 38.96it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 422/1000 [00:11<00:15, 38.43it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 426/1000 [00:11<00:15, 37.99it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 430/1000 [00:11<00:15, 37.69it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 434/1000 [00:11<00:15, 37.51it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 438/1000 [00:11<00:15, 37.44it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 442/1000 [00:11<00:14, 37.33it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 446/1000 [00:11<00:14, 37.22it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 451/1000 [00:11<00:13, 39.80it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 456/1000 [00:11<00:13, 41.65it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 461/1000 [00:12<00:13, 39.34it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 465/1000 [00:12<00:15, 34.58it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 469/1000 [00:12<00:15, 35.21it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 474/1000 [00:12<00:14, 37.52it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 478/1000 [00:12<00:13, 37.66it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 482/1000 [00:12<00:13, 37.49it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 486/1000 [00:12<00:13, 37.38it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 490/1000 [00:12<00:13, 37.29it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 494/1000 [00:12<00:13, 37.20it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 498/1000 [00:13<00:13, 37.15it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 502/1000 [00:13<00:13, 37.18it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 506/1000 [00:13<00:13, 37.18it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 510/1000 [00:13<00:13, 37.13it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 514/1000 [00:13<00:13, 37.08it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 518/1000 [00:13<00:13, 37.07it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 522/1000 [00:13<00:12, 37.41it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 526/1000 [00:13<00:12, 37.31it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 530/1000 [00:13<00:12, 37.24it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 534/1000 [00:14<00:12, 37.15it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 538/1000 [00:14<00:12, 37.15it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 542/1000 [00:14<00:12, 37.15it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 546/1000 [00:14<00:12, 37.12it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 550/1000 [00:14<00:12, 37.04it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 554/1000 [00:14<00:12, 37.04it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 558/1000 [00:14<00:12, 36.80it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 562/1000 [00:14<00:11, 36.90it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 567/1000 [00:14<00:10, 39.40it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 571/1000 [00:15<00:11, 38.67it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 575/1000 [00:15<00:11, 38.22it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 579/1000 [00:15<00:11, 37.93it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 583/1000 [00:15<00:11, 37.68it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 587/1000 [00:15<00:11, 37.45it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 591/1000 [00:15<00:10, 37.32it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 595/1000 [00:15<00:10, 37.31it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 599/1000 [00:15<00:10, 37.28it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 603/1000 [00:15<00:10, 37.21it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 607/1000 [00:15<00:10, 37.15it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 611/1000 [00:16<00:10, 37.14it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 616/1000 [00:16<00:09, 39.77it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 620/1000 [00:16<00:09, 38.94it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 624/1000 [00:16<00:09, 38.34it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 628/1000 [00:16<00:09, 37.95it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 632/1000 [00:16<00:09, 37.75it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 636/1000 [00:16<00:09, 37.57it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 640/1000 [00:16<00:09, 37.40it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 645/1000 [00:16<00:08, 39.91it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 650/1000 [00:17<00:08, 41.79it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 655/1000 [00:17<00:08, 40.19it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 660/1000 [00:17<00:08, 39.13it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 664/1000 [00:17<00:08, 38.57it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 668/1000 [00:17<00:08, 38.23it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 672/1000 [00:17<00:08, 37.93it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 676/1000 [00:17<00:08, 37.66it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 680/1000 [00:17<00:08, 37.47it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 684/1000 [00:17<00:08, 37.42it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 688/1000 [00:18<00:08, 37.37it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 692/1000 [00:18<00:08, 37.28it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 696/1000 [00:18<00:08, 37.18it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 700/1000 [00:18<00:08, 37.14it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 704/1000 [00:18<00:07, 37.17it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 708/1000 [00:18<00:07, 37.18it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 712/1000 [00:18<00:07, 37.44it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 716/1000 [00:18<00:07, 37.35it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 720/1000 [00:18<00:07, 37.33it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 724/1000 [00:19<00:07, 37.24it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 728/1000 [00:19<00:07, 37.14it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 732/1000 [00:19<00:07, 37.10it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 736/1000 [00:19<00:07, 37.14it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 740/1000 [00:19<00:07, 37.14it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 744/1000 [00:19<00:06, 36.77it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 748/1000 [00:19<00:06, 36.83it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 753/1000 [00:19<00:06, 39.64it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 757/1000 [00:19<00:06, 38.88it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 761/1000 [00:20<00:06, 38.34it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 765/1000 [00:20<00:06, 37.94it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 769/1000 [00:20<00:06, 37.69it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 773/1000 [00:20<00:06, 37.70it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 777/1000 [00:20<00:05, 37.49it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 781/1000 [00:20<00:05, 37.33it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 785/1000 [00:20<00:05, 37.20it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 789/1000 [00:20<00:05, 37.16it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 793/1000 [00:20<00:05, 37.11it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 798/1000 [00:21<00:05, 38.30it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 802/1000 [00:21<00:05, 37.92it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 806/1000 [00:21<00:05, 37.71it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 811/1000 [00:21<00:04, 39.89it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 815/1000 [00:21<00:04, 39.02it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 819/1000 [00:21<00:04, 38.46it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 823/1000 [00:21<00:04, 38.11it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 827/1000 [00:21<00:04, 37.82it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 831/1000 [00:21<00:04, 37.58it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 835/1000 [00:21<00:04, 37.40it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 839/1000 [00:22<00:04, 37.26it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 843/1000 [00:22<00:04, 37.23it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 847/1000 [00:22<00:04, 37.17it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 851/1000 [00:22<00:03, 37.30it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 855/1000 [00:22<00:03, 37.19it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 859/1000 [00:22<00:03, 37.20it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 863/1000 [00:22<00:03, 37.21it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 867/1000 [00:22<00:03, 37.17it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 871/1000 [00:22<00:03, 37.10it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 875/1000 [00:23<00:03, 37.07it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 879/1000 [00:23<00:03, 37.11it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 883/1000 [00:23<00:03, 29.49it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 888/1000 [00:23<00:03, 32.90it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 892/1000 [00:23<00:03, 33.95it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 896/1000 [00:23<00:02, 34.80it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 900/1000 [00:23<00:02, 35.41it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 904/1000 [00:23<00:02, 35.85it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 908/1000 [00:24<00:02, 36.41it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 912/1000 [00:24<00:02, 36.58it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 916/1000 [00:24<00:02, 36.76it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 920/1000 [00:24<00:02, 36.57it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 924/1000 [00:24<00:02, 36.65it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 928/1000 [00:24<00:01, 36.73it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 933/1000 [00:24<00:01, 39.48it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 937/1000 [00:24<00:01, 38.72it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 941/1000 [00:24<00:01, 38.20it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 945/1000 [00:25<00:01, 37.87it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 950/1000 [00:25<00:01, 40.22it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 955/1000 [00:25<00:01, 39.98it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 960/1000 [00:25<00:01, 39.03it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 964/1000 [00:25<00:00, 38.46it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 968/1000 [00:25<00:00, 38.04it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 972/1000 [00:25<00:00, 37.71it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 976/1000 [00:25<00:00, 37.57it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 980/1000 [00:25<00:00, 37.43it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 985/1000 [00:26<00:00, 39.07it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 989/1000 [00:26<00:00, 38.46it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 994/1000 [00:26<00:00, 40.75it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 999/1000 [00:26<00:00, 39.48it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:26<00:00, 37.86it/s][[36m2024-09-27 04:53:14,266[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - train Dataset already processed[0m
[[36m2024-09-27 04:53:14,267[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Processing val dataset before training[0m
[[36m2024-09-27 04:53:14,364[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Shape of processed val data: {'cancer_volume': (1000, 60), 'chemo_dosage': (1000, 60), 'radio_dosage': (1000, 60), 'chemo_application': (1000, 60), 'radio_application': (1000, 60), 'chemo_probabilities': (1000, 60), 'radio_probabilities': (1000, 60), 'sequence_lengths': (1000,), 'death_flags': (1000, 60), 'recovery_flags': (1000, 60), 'patient_types': (1000,), 'prev_treatments': (1000, 59, 4), 'current_treatments': (1000, 59, 4), 'current_covariates': (1000, 59, 2), 'outputs': (1000, 59, 1), 'active_entries': (1000, 59, 1), 'unscaled_outputs': (1000, 59, 1), 'prev_outputs': (1000, 59, 1), 'static_features': (1000, 1)}[0m
[[36m2024-09-27 04:53:14,364[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Processing test dataset before training[0m
[[36m2024-09-27 04:53:34,510[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Shape of processed test data: {'cancer_volume': (222916, 60), 'chemo_application': (222916, 60), 'radio_application': (222916, 60), 'sequence_lengths': (222916,), 'patient_types': (222916,), 'prev_treatments': (222916, 59, 4), 'current_treatments': (222916, 59, 4), 'current_covariates': (222916, 59, 2), 'outputs': (222916, 59, 1), 'active_entries': (222916, 59, 1), 'unscaled_outputs': (222916, 59, 1), 'prev_outputs': (222916, 59, 1), 'static_features': (222916, 1)}[0m
[[36m2024-09-27 04:53:34,741[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f346dd8b340>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m
[[36m2024-09-27 04:53:39,317[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f346dd8b220>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m
[[36m2024-09-27 04:53:47,755[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f346dd8bf40>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m
[[36m2024-09-27 04:54:04,351[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f346a2f1d00>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m
[[36m2024-09-27 04:54:36,600[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=0, connect=0, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f346a2e1ac0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m

Error executing job with overrides: ['+dataset=cancer_sim', '+backbone=crn', "+backbone/crn_hparams/cancer_sim_subgroup_random='3'", 'exp.seed=10']
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connection.py", line 196, in _new_conn
    sock = connection.create_connection(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 495, in _make_request
    conn.request(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connection.py", line 398, in request
    self.endheaders()
  File "/usr/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connection.py", line 236, in connect
    self.sock = self._new_conn()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connection.py", line 211, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f346a2e1220>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 873, in urlopen
    return self.urlopen(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 873, in urlopen
    return self.urlopen(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 873, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f346a2e1220>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 187, in http_request
    return _get_http_response_with_retries(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/request_utils.py", line 237, in _get_http_response_with_retries
    return session.request(method, url, allow_redirects=allow_redirects, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f346a2e1220>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "runnables/train_enc_dec.py", line 54, in main
    artifacts_path = hydra.utils.to_absolute_path(mlf_logger.experiment.get_run(mlf_logger.run_id).info.artifact_uri)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/loggers/base.py", line 42, in experiment
    return get_experiment() or DummyExperiment()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py", line 48, in wrapped_fn
    return fn(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/loggers/base.py", line 40, in get_experiment
    return fn(self)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/loggers/mlflow.py", line 152, in experiment
    expt = self._mlflow_client.get_experiment_by_name(self._experiment_name)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/tracking/client.py", line 1240, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 484, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 518, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 81, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 357, in call_endpoint
    response = http_request(**call_kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 210, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://127.0.0.1:5000/api/2.0/mlflow/experiments/get-by-name failed with exception HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f346a2e1220>: Failed to establish a new connection: [Errno 111] Connection refused'))

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
/var/spool/slurmd/job13715/slurm_script: line 20: exp.mlflow_uri=http://127.0.0.1:8003: No such file or directory
