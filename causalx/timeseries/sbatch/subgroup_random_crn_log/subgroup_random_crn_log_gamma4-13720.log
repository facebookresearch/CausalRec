[2024-09-27 07:45:41 +0000] [2169559] [INFO] Starting gunicorn 22.0.0
[2024-09-27 07:45:41 +0000] [2169559] [INFO] Listening at: http://127.0.0.1:8004 (2169559)
[2024-09-27 07:45:41 +0000] [2169559] [INFO] Using worker: sync
[2024-09-27 07:45:41 +0000] [2169563] [INFO] Booting worker with pid: 2169563
[2024-09-27 07:45:41 +0000] [2169564] [INFO] Booting worker with pid: 2169564
[2024-09-27 07:45:41 +0000] [2169565] [INFO] Booting worker with pid: 2169565
[2024-09-27 07:45:41 +0000] [2169566] [INFO] Booting worker with pid: 2169566
runnables/train_enc_dec.py:18: UserWarning: 
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
  @hydra.main(config_name=f'config.yaml', config_path='../config/')
[[36m2024-09-27 07:45:55,322[0m][[34m__main__[0m][[32mINFO[0m] - 
model:
  dim_treatments: 4
  dim_vitals: 0
  dim_static_features: 1
  dim_outcomes: 1
  name: CRN
  encoder:
    _target_: src.models.crn.CRNEncoder
    seq_hidden_units: 24
    br_size: 24
    fc_hidden_units: 96
    dropout_rate: 0.2
    num_layer: 1
    batch_size: 1024
    optimizer:
      optimizer_cls: adam
      learning_rate: 0.005
      weight_decay: 0.0
      lr_scheduler: false
    tune_hparams: false
    tune_range: 50
    hparams_grid: null
    resources_per_trial: null
  train_decoder: true
  decoder:
    _target_: src.models.crn.CRNDecoder
    seq_hidden_units: null
    br_size: 24
    fc_hidden_units: 12
    dropout_rate: 0.1
    num_layer: 1
    batch_size: 4096
    optimizer:
      optimizer_cls: adam
      learning_rate: 0.01
      weight_decay: 0.0
      lr_scheduler: false
    tune_hparams: false
    tune_range: 30
    hparams_grid: null
    resources_per_trial: null
dataset:
  val_batch_size: 512
  treatment_mode: multiclass
  _target_: src.data.SyntheticCancerDatasetCollection
  name: tumor_generator
  coeff: 4.0
  chemo_coeff: 4.0
  radio_coeff: 4.0
  seed: 10
  random: true
  num_patients:
    train: 10000
    val: 1000
    test: 1000
  window_size: 15
  lag: 0
  max_seq_length: 60
  projection_horizon: 5
  cf_seq_mode: sliding_treatment
exp:
  seed: 10
  gpus:
  - 0
  max_epochs: 200
  logging: true
  mlflow_uri: http://127.0.0.1:5000
  unscale_rmse: true
  percentage_rmse: true
  alpha: 0
  update_alpha: true
  alpha_rate: exp
  balancing: subgroup
  bce_weight: false
  weights_ema: true
  beta: 0.99
  alpha_wass: 0.001
  alpha_wass_epoch: false
  alpha_wass_growth: 0.001
  alpha_wass_max: 0.01
  num_timepoints: 59
[0m
/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/hydra/_internal/hydra.py:119: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/1.2/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  ret = run_job(
Global seed set to 10
[[36m2024-09-27 07:45:55,334[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-27 07:45:55,335[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-27 07:45:55,336[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-27 07:45:55,337[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-27 07:45:55,339[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-27 07:45:55,348[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 4658 patients[0m
[[36m2024-09-27 07:45:55,353[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 9338 patients[0m
[[36m2024-09-27 07:45:55,358[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 13912 patients[0m
[[36m2024-09-27 07:45:55,365[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-27 07:45:55,370[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m
  0%|          | 0/10000 [00:00<?, ?it/s]/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer_avg/src/data/cancer_sim/cancer_simulation.py:346: RuntimeWarning: overflow encountered in exp
  if recovery_rvs[i, t] < np.exp(-cancer_volume[i, t] * TUMOUR_CELL_DENSITY):
  1%|          | 64/10000 [00:00<00:15, 637.38it/s]  1%|â–         | 129/10000 [00:00<00:15, 639.36it/s]  2%|â–         | 193/10000 [00:00<00:15, 636.90it/s]  3%|â–Ž         | 259/10000 [00:00<00:15, 643.33it/s]  3%|â–Ž         | 324/10000 [00:00<00:15, 633.65it/s]  4%|â–         | 390/10000 [00:00<00:14, 641.21it/s]  5%|â–         | 455/10000 [00:00<00:14, 642.79it/s]  5%|â–Œ         | 520/10000 [00:00<00:14, 643.47it/s]  6%|â–Œ         | 585/10000 [00:00<00:14, 643.20it/s]  6%|â–‹         | 650/10000 [00:01<00:14, 641.57it/s]  7%|â–‹         | 715/10000 [00:01<00:14, 639.14it/s]  8%|â–Š         | 779/10000 [00:01<00:14, 635.08it/s]  8%|â–Š         | 843/10000 [00:01<00:14, 633.13it/s]  9%|â–‰         | 907/10000 [00:01<00:14, 632.02it/s] 10%|â–‰         | 972/10000 [00:01<00:14, 634.38it/s] 10%|â–ˆ         | 1036/10000 [00:01<00:14, 635.72it/s] 11%|â–ˆ         | 1100/10000 [00:01<00:14, 630.81it/s] 12%|â–ˆâ–        | 1165/10000 [00:01<00:13, 636.02it/s] 12%|â–ˆâ–        | 1229/10000 [00:01<00:13, 629.47it/s] 13%|â–ˆâ–Ž        | 1292/10000 [00:02<00:14, 621.78it/s] 14%|â–ˆâ–Ž        | 1356/10000 [00:02<00:13, 624.25it/s] 14%|â–ˆâ–        | 1419/10000 [00:02<00:13, 620.15it/s] 15%|â–ˆâ–        | 1482/10000 [00:02<00:13, 620.03it/s] 15%|â–ˆâ–Œ        | 1546/10000 [00:02<00:13, 625.33it/s] 16%|â–ˆâ–Œ        | 1614/10000 [00:02<00:13, 638.83it/s] 17%|â–ˆâ–‹        | 1678/10000 [00:02<00:13, 637.79it/s] 17%|â–ˆâ–‹        | 1744/10000 [00:02<00:12, 644.10it/s] 18%|â–ˆâ–Š        | 1810/10000 [00:02<00:12, 647.55it/s] 19%|â–ˆâ–‰        | 1875/10000 [00:02<00:12, 637.07it/s] 19%|â–ˆâ–‰        | 1940/10000 [00:03<00:12, 639.48it/s] 20%|â–ˆâ–ˆ        | 2006/10000 [00:03<00:12, 643.83it/s] 21%|â–ˆâ–ˆ        | 2071/10000 [00:03<00:12, 642.70it/s] 21%|â–ˆâ–ˆâ–       | 2136/10000 [00:03<00:12, 639.87it/s] 22%|â–ˆâ–ˆâ–       | 2203/10000 [00:03<00:12, 645.80it/s] 23%|â–ˆâ–ˆâ–Ž       | 2268/10000 [00:03<00:12, 640.45it/s] 23%|â–ˆâ–ˆâ–Ž       | 2333/10000 [00:03<00:11, 639.21it/s] 24%|â–ˆâ–ˆâ–       | 2399/10000 [00:03<00:11, 642.85it/s] 25%|â–ˆâ–ˆâ–       | 2466/10000 [00:03<00:11, 648.38it/s] 25%|â–ˆâ–ˆâ–Œ       | 2531/10000 [00:03<00:11, 647.54it/s] 26%|â–ˆâ–ˆâ–Œ       | 2596/10000 [00:04<00:11, 636.73it/s] 27%|â–ˆâ–ˆâ–‹       | 2664/10000 [00:04<00:11, 648.26it/s] 27%|â–ˆâ–ˆâ–‹       | 2732/10000 [00:04<00:11, 655.49it/s] 28%|â–ˆâ–ˆâ–Š       | 2798/10000 [00:04<00:11, 647.29it/s] 29%|â–ˆâ–ˆâ–Š       | 2865/10000 [00:04<00:10, 653.92it/s] 29%|â–ˆâ–ˆâ–‰       | 2931/10000 [00:04<00:10, 646.33it/s] 30%|â–ˆâ–ˆâ–‰       | 2996/10000 [00:04<00:10, 642.17it/s] 31%|â–ˆâ–ˆâ–ˆ       | 3061/10000 [00:04<00:10, 642.37it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 3127/10000 [00:04<00:10, 645.82it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 3192/10000 [00:05<00:10, 628.92it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3255/10000 [00:05<00:11, 565.51it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3320/10000 [00:05<00:11, 586.04it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 3384/10000 [00:05<00:11, 600.84it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 3448/10000 [00:05<00:10, 610.21it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 3512/10000 [00:05<00:10, 617.42it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 3579/10000 [00:05<00:10, 629.99it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 3646/10000 [00:05<00:09, 640.80it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 3711/10000 [00:05<00:09, 633.45it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 3775/10000 [00:05<00:09, 631.89it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 3839/10000 [00:06<00:09, 633.34it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 3904/10000 [00:06<00:09, 637.72it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 3968/10000 [00:06<00:09, 633.28it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4032/10000 [00:06<00:09, 635.21it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4096/10000 [00:06<00:09, 631.08it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4160/10000 [00:06<00:09, 631.17it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4224/10000 [00:06<00:09, 632.67it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 4288/10000 [00:06<00:09, 632.34it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 4352/10000 [00:06<00:09, 627.53it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4416/10000 [00:06<00:08, 628.63it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4481/10000 [00:07<00:08, 632.73it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 4546/10000 [00:07<00:08, 635.19it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 4610/10000 [00:07<00:08, 631.46it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 4674/10000 [00:07<00:08, 633.89it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 4738/10000 [00:07<00:08, 630.11it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 4804/10000 [00:07<00:08, 637.89it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 4870/10000 [00:07<00:07, 643.69it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 4935/10000 [00:07<00:07, 637.21it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 4999/10000 [00:07<00:07, 635.50it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5063/10000 [00:07<00:07, 632.18it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5128/10000 [00:08<00:07, 637.14it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5192/10000 [00:08<00:07, 634.96it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 5259/10000 [00:08<00:07, 643.03it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 5324/10000 [00:08<00:07, 640.87it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5390/10000 [00:08<00:07, 645.49it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5455/10000 [00:08<00:07, 646.58it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5521/10000 [00:08<00:06, 648.48it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5586/10000 [00:08<00:06, 645.93it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 5652/10000 [00:08<00:06, 647.02it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 5719/10000 [00:08<00:06, 652.13it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 5785/10000 [00:09<00:06, 645.37it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 5851/10000 [00:09<00:06, 648.07it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 5916/10000 [00:09<00:06, 645.06it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 5981/10000 [00:09<00:06, 643.66it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6046/10000 [00:09<00:06, 634.97it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6111/10000 [00:09<00:06, 638.32it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6175/10000 [00:09<00:06, 636.25it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6241/10000 [00:09<00:05, 640.65it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 6306/10000 [00:09<00:05, 638.42it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 6372/10000 [00:10<00:05, 642.35it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6437/10000 [00:10<00:05, 640.03it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 6502/10000 [00:10<00:05, 635.26it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 6566/10000 [00:10<00:05, 635.76it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6630/10000 [00:10<00:05, 631.84it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6694/10000 [00:10<00:05, 628.46it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 6761/10000 [00:10<00:05, 639.19it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 6825/10000 [00:10<00:04, 635.45it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 6889/10000 [00:10<00:04, 636.23it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 6953/10000 [00:10<00:04, 620.22it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7016/10000 [00:11<00:04, 622.98it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7080/10000 [00:11<00:04, 625.88it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7143/10000 [00:11<00:04, 615.82it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7208/10000 [00:11<00:04, 625.73it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 7271/10000 [00:11<00:04, 616.88it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 7334/10000 [00:11<00:04, 619.60it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7397/10000 [00:11<00:04, 616.43it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7463/10000 [00:11<00:04, 626.51it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 7527/10000 [00:11<00:03, 630.48it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 7592/10000 [00:11<00:03, 635.83it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 7657/10000 [00:12<00:03, 637.19it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 7722/10000 [00:12<00:03, 638.24it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7786/10000 [00:12<00:03, 636.47it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7852/10000 [00:12<00:03, 643.24it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 7918/10000 [00:12<00:03, 646.42it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 7983/10000 [00:12<00:03, 637.55it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8047/10000 [00:12<00:03, 636.00it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8111/10000 [00:12<00:02, 632.04it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8175/10000 [00:12<00:02, 633.73it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8239/10000 [00:12<00:02, 630.70it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 8303/10000 [00:13<00:02, 633.28it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 8367/10000 [00:13<00:02, 630.26it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8431/10000 [00:13<00:02, 628.53it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8495/10000 [00:13<00:02, 630.46it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 8559/10000 [00:13<00:02, 630.41it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 8625/10000 [00:13<00:02, 637.54it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 8690/10000 [00:13<00:02, 641.17it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 8755/10000 [00:13<00:01, 636.74it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 8819/10000 [00:13<00:01, 631.89it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8883/10000 [00:13<00:01, 629.54it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8947/10000 [00:14<00:01, 631.87it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9011/10000 [00:14<00:01, 619.66it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9075/10000 [00:14<00:01, 625.32it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9141/10000 [00:14<00:01, 635.48it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9205/10000 [00:14<00:01, 633.55it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 9269/10000 [00:14<00:01, 633.28it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 9333/10000 [00:14<00:01, 632.47it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9398/10000 [00:14<00:00, 635.07it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9462/10000 [00:14<00:00, 633.95it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 9528/10000 [00:15<00:00, 639.78it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 9592/10000 [00:15<00:00, 639.79it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 9656/10000 [00:15<00:00, 634.24it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 9720/10000 [00:15<00:00, 623.66it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 9783/10000 [00:15<00:00, 623.09it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 9846/10000 [00:15<00:00, 622.65it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 9910/10000 [00:15<00:00, 624.72it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 9974/10000 [00:15<00:00, 628.23it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10000/10000 [00:15<00:00, 634.17it/s]Modified current_covariates:
[[36m2024-09-27 07:46:11,503[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Processing train dataset before training[0m
[[36m2024-09-27 07:46:12,426[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Shape of processed train data: {'cancer_volume': (10000, 60), 'chemo_dosage': (10000, 60), 'radio_dosage': (10000, 60), 'chemo_application': (10000, 60), 'radio_application': (10000, 60), 'chemo_probabilities': (10000, 60), 'radio_probabilities': (10000, 60), 'sequence_lengths': (10000,), 'death_flags': (10000, 60), 'recovery_flags': (10000, 60), 'patient_types': (10000,), 'prev_treatments': (10000, 59, 4), 'current_treatments': (10000, 59, 4), 'current_covariates': (10000, 59, 2), 'outputs': (10000, 59, 1), 'active_entries': (10000, 59, 1), 'unscaled_outputs': (10000, 59, 1), 'prev_outputs': (10000, 59, 1), 'static_features': (10000, 1)}[0m
before change [-0.10704545 -1.23120471]
after change [-0.03583885  0.09391788]
before change [-0.1457975  -1.23120471]
after change [-0.14391977  0.22986788]
[[36m2024-09-27 07:46:12,483[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-27 07:46:12,484[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-27 07:46:12,485[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-27 07:46:12,486[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-27 07:46:12,487[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-27 07:46:12,488[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 455 patients[0m
[[36m2024-09-27 07:46:12,490[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 905 patients[0m
[[36m2024-09-27 07:46:12,491[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 1366 patients[0m
[[36m2024-09-27 07:46:12,492[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-27 07:46:12,493[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m

  0%|          | 0/1000 [00:00<?, ?it/s]/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer_avg/src/data/cancer_sim/cancer_simulation.py:346: RuntimeWarning: overflow encountered in exp
  if recovery_rvs[i, t] < np.exp(-cancer_volume[i, t] * TUMOUR_CELL_DENSITY):
  6%|â–‹         | 64/1000 [00:00<00:01, 634.78it/s] 13%|â–ˆâ–Ž        | 128/1000 [00:00<00:01, 627.38it/s] 19%|â–ˆâ–‰        | 191/1000 [00:00<00:01, 624.45it/s] 26%|â–ˆâ–ˆâ–Œ       | 256/1000 [00:00<00:01, 632.43it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 320/1000 [00:00<00:01, 630.34it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 384/1000 [00:00<00:00, 623.90it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 450/1000 [00:00<00:00, 632.37it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 514/1000 [00:00<00:00, 634.53it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 578/1000 [00:00<00:00, 635.81it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 642/1000 [00:01<00:00, 631.04it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 708/1000 [00:01<00:00, 637.92it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 772/1000 [00:01<00:00, 636.55it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 836/1000 [00:01<00:00, 636.13it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 900/1000 [00:01<00:00, 634.44it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 964/1000 [00:01<00:00, 635.15it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:01<00:00, 632.82it/s][[36m2024-09-27 07:46:14,079[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-27 07:46:14,079[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-27 07:46:14,080[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-27 07:46:14,080[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-27 07:46:14,081[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-27 07:46:14,083[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 493 patients[0m
[[36m2024-09-27 07:46:14,084[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 947 patients[0m
[[36m2024-09-27 07:46:14,085[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 1403 patients[0m
[[36m2024-09-27 07:46:14,086[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-27 07:46:14,087[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m

  0%|          | 0/1000 [00:00<?, ?it/s]  1%|â–         | 14/1000 [00:00<00:07, 138.00it/s]  3%|â–Ž         | 28/1000 [00:00<00:07, 138.55it/s]  4%|â–         | 42/1000 [00:00<00:06, 138.70it/s]  6%|â–Œ         | 56/1000 [00:00<00:06, 138.79it/s]  7%|â–‹         | 70/1000 [00:00<00:06, 138.78it/s]  8%|â–Š         | 84/1000 [00:00<00:06, 138.77it/s] 10%|â–ˆ         | 100/1000 [00:00<00:06, 143.17it/s] 12%|â–ˆâ–        | 115/1000 [00:00<00:06, 141.61it/s] 13%|â–ˆâ–Ž        | 130/1000 [00:00<00:06, 140.68it/s] 14%|â–ˆâ–        | 145/1000 [00:01<00:06, 141.81it/s] 16%|â–ˆâ–Œ        | 160/1000 [00:01<00:05, 140.33it/s] 18%|â–ˆâ–Š        | 175/1000 [00:01<00:05, 139.78it/s] 19%|â–ˆâ–‰        | 189/1000 [00:01<00:05, 139.30it/s] 20%|â–ˆâ–ˆ        | 203/1000 [00:01<00:05, 139.03it/s] 22%|â–ˆâ–ˆâ–       | 217/1000 [00:01<00:05, 138.85it/s] 23%|â–ˆâ–ˆâ–Ž       | 232/1000 [00:01<00:05, 141.15it/s] 25%|â–ˆâ–ˆâ–       | 247/1000 [00:01<00:05, 140.39it/s] 26%|â–ˆâ–ˆâ–Œ       | 262/1000 [00:01<00:05, 139.89it/s] 28%|â–ˆâ–ˆâ–Š       | 277/1000 [00:01<00:05, 142.32it/s] 29%|â–ˆâ–ˆâ–‰       | 292/1000 [00:02<00:04, 143.12it/s] 31%|â–ˆâ–ˆâ–ˆ       | 307/1000 [00:02<00:04, 141.75it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 323/1000 [00:02<00:04, 145.19it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 339/1000 [00:02<00:04, 148.74it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 354/1000 [00:02<00:04, 148.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 369/1000 [00:02<00:04, 147.13it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 384/1000 [00:02<00:04, 144.97it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 399/1000 [00:02<00:04, 142.87it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 414/1000 [00:02<00:04, 144.10it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 431/1000 [00:03<00:03, 149.88it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 448/1000 [00:03<00:03, 153.74it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 464/1000 [00:03<00:03, 151.61it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 480/1000 [00:03<00:03, 148.90it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 495/1000 [00:03<00:03, 148.78it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 510/1000 [00:03<00:03, 148.69it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 525/1000 [00:03<00:03, 148.56it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 542/1000 [00:03<00:03, 152.03it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 558/1000 [00:03<00:02, 152.01it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 574/1000 [00:03<00:02, 154.07it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 592/1000 [00:04<00:02, 161.30it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 616/1000 [00:04<00:02, 182.47it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 635/1000 [00:04<00:02, 182.18it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 656/1000 [00:04<00:01, 189.04it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 675/1000 [00:04<00:01, 186.51it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 697/1000 [00:04<00:01, 194.56it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 717/1000 [00:04<00:01, 181.80it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 736/1000 [00:04<00:01, 166.62it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 753/1000 [00:04<00:01, 160.51it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 770/1000 [00:05<00:01, 153.46it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 786/1000 [00:05<00:01, 151.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 802/1000 [00:05<00:01, 150.46it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 818/1000 [00:05<00:01, 146.85it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 833/1000 [00:05<00:01, 144.41it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 848/1000 [00:05<00:01, 142.65it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 863/1000 [00:05<00:00, 141.43it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 878/1000 [00:05<00:00, 140.49it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 893/1000 [00:05<00:00, 139.05it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 907/1000 [00:06<00:00, 138.82it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 921/1000 [00:06<00:00, 138.67it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 935/1000 [00:06<00:00, 138.49it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 949/1000 [00:06<00:00, 138.44it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 963/1000 [00:06<00:00, 138.48it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 977/1000 [00:06<00:00, 138.49it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 991/1000 [00:06<00:00, 138.52it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:06<00:00, 148.52it/s]Call to simulate counterfactuals data
[[36m2024-09-27 07:46:20,822[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-27 07:46:20,823[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-27 07:46:20,824[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-27 07:46:20,825[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-27 07:46:20,825[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-27 07:46:20,827[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 445 patients[0m
[[36m2024-09-27 07:46:20,829[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 895 patients[0m
[[36m2024-09-27 07:46:20,830[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 1355 patients[0m
[[36m2024-09-27 07:46:20,831[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-27 07:46:20,832[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m

  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 4/1000 [00:00<00:26, 37.04it/s]  1%|          | 8/1000 [00:00<00:26, 37.10it/s]  1%|          | 12/1000 [00:00<00:26, 37.24it/s]  2%|â–         | 16/1000 [00:00<00:26, 37.22it/s]  2%|â–         | 20/1000 [00:00<00:26, 37.19it/s]  2%|â–         | 24/1000 [00:00<00:26, 37.18it/s]/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer_avg/src/data/cancer_sim/cancer_simulation.py:734: RuntimeWarning: invalid value encountered in log
  (1 + rho * np.log(K / (counterfactual_cancer_volume[current_t] + 1e-07) + 1e-07) -
  3%|â–Ž         | 29/1000 [00:00<00:24, 39.93it/s]  3%|â–Ž         | 33/1000 [00:00<00:24, 39.10it/s]  4%|â–Ž         | 37/1000 [00:00<00:24, 38.53it/s]  4%|â–         | 41/1000 [00:01<00:25, 38.08it/s]  4%|â–         | 45/1000 [00:01<00:25, 37.74it/s]  5%|â–         | 49/1000 [00:01<00:25, 37.59it/s]  5%|â–Œ         | 53/1000 [00:01<00:25, 37.48it/s]  6%|â–Œ         | 57/1000 [00:01<00:25, 37.44it/s]  6%|â–Œ         | 61/1000 [00:01<00:25, 37.31it/s]  6%|â–‹         | 65/1000 [00:01<00:25, 37.23it/s]  7%|â–‹         | 69/1000 [00:01<00:25, 37.20it/s]  7%|â–‹         | 74/1000 [00:01<00:23, 39.84it/s]  8%|â–Š         | 78/1000 [00:02<00:23, 39.03it/s]  8%|â–Š         | 82/1000 [00:02<00:23, 38.45it/s]  9%|â–Š         | 86/1000 [00:02<00:24, 38.05it/s]  9%|â–‰         | 90/1000 [00:02<00:24, 37.75it/s]  9%|â–‰         | 94/1000 [00:02<00:24, 37.60it/s] 10%|â–‰         | 99/1000 [00:02<00:22, 39.58it/s] 10%|â–ˆ         | 103/1000 [00:02<00:23, 38.86it/s] 11%|â–ˆ         | 107/1000 [00:02<00:23, 38.31it/s] 11%|â–ˆ         | 111/1000 [00:02<00:23, 37.96it/s] 12%|â–ˆâ–        | 115/1000 [00:03<00:23, 37.69it/s] 12%|â–ˆâ–        | 119/1000 [00:03<00:23, 37.53it/s] 12%|â–ˆâ–        | 124/1000 [00:03<00:21, 40.21it/s] 13%|â–ˆâ–Ž        | 129/1000 [00:03<00:22, 39.18it/s] 13%|â–ˆâ–Ž        | 133/1000 [00:03<00:22, 38.60it/s] 14%|â–ˆâ–Ž        | 137/1000 [00:03<00:22, 38.18it/s] 14%|â–ˆâ–        | 141/1000 [00:03<00:22, 37.88it/s] 14%|â–ˆâ–        | 145/1000 [00:03<00:22, 37.66it/s] 15%|â–ˆâ–        | 149/1000 [00:03<00:22, 37.53it/s] 15%|â–ˆâ–Œ        | 153/1000 [00:04<00:22, 37.07it/s] 16%|â–ˆâ–Œ        | 157/1000 [00:04<00:22, 37.09it/s] 16%|â–ˆâ–Œ        | 162/1000 [00:04<00:21, 39.77it/s] 17%|â–ˆâ–‹        | 166/1000 [00:04<00:21, 38.99it/s] 17%|â–ˆâ–‹        | 170/1000 [00:04<00:21, 38.25it/s] 17%|â–ˆâ–‹        | 174/1000 [00:04<00:22, 36.76it/s] 18%|â–ˆâ–Š        | 178/1000 [00:04<00:23, 35.20it/s] 18%|â–ˆâ–Š        | 182/1000 [00:04<00:22, 35.74it/s] 19%|â–ˆâ–Š        | 187/1000 [00:04<00:21, 38.17it/s] 19%|â–ˆâ–‰        | 191/1000 [00:05<00:21, 37.86it/s] 20%|â–ˆâ–‰        | 195/1000 [00:05<00:21, 37.64it/s] 20%|â–ˆâ–‰        | 199/1000 [00:05<00:21, 37.48it/s] 20%|â–ˆâ–ˆ        | 203/1000 [00:05<00:21, 37.37it/s] 21%|â–ˆâ–ˆ        | 208/1000 [00:05<00:19, 39.84it/s] 21%|â–ˆâ–ˆ        | 212/1000 [00:05<00:20, 39.04it/s] 22%|â–ˆâ–ˆâ–       | 216/1000 [00:05<00:20, 38.47it/s] 22%|â–ˆâ–ˆâ–       | 220/1000 [00:05<00:20, 38.07it/s] 22%|â–ˆâ–ˆâ–       | 224/1000 [00:05<00:20, 37.73it/s] 23%|â–ˆâ–ˆâ–Ž       | 228/1000 [00:06<00:20, 37.49it/s] 23%|â–ˆâ–ˆâ–Ž       | 232/1000 [00:06<00:20, 37.27it/s] 24%|â–ˆâ–ˆâ–Ž       | 236/1000 [00:06<00:20, 37.04it/s] 24%|â–ˆâ–ˆâ–       | 240/1000 [00:06<00:20, 36.99it/s] 24%|â–ˆâ–ˆâ–       | 244/1000 [00:06<00:20, 36.97it/s] 25%|â–ˆâ–ˆâ–       | 248/1000 [00:06<00:20, 36.00it/s] 25%|â–ˆâ–ˆâ–Œ       | 252/1000 [00:06<00:20, 36.20it/s] 26%|â–ˆâ–ˆâ–Œ       | 256/1000 [00:06<00:20, 36.45it/s] 26%|â–ˆâ–ˆâ–Œ       | 260/1000 [00:06<00:20, 36.60it/s] 26%|â–ˆâ–ˆâ–‹       | 264/1000 [00:06<00:20, 36.63it/s] 27%|â–ˆâ–ˆâ–‹       | 268/1000 [00:07<00:19, 36.76it/s] 27%|â–ˆâ–ˆâ–‹       | 272/1000 [00:07<00:19, 36.87it/s] 28%|â–ˆâ–ˆâ–Š       | 276/1000 [00:07<00:19, 36.93it/s] 28%|â–ˆâ–ˆâ–Š       | 280/1000 [00:07<00:19, 36.96it/s] 28%|â–ˆâ–ˆâ–Š       | 284/1000 [00:07<00:19, 36.83it/s] 29%|â–ˆâ–ˆâ–‰       | 288/1000 [00:07<00:19, 36.92it/s] 29%|â–ˆâ–ˆâ–‰       | 292/1000 [00:07<00:19, 36.97it/s] 30%|â–ˆâ–ˆâ–‰       | 296/1000 [00:07<00:19, 36.98it/s] 30%|â–ˆâ–ˆâ–ˆ       | 300/1000 [00:07<00:18, 37.03it/s] 30%|â–ˆâ–ˆâ–ˆ       | 305/1000 [00:08<00:17, 39.65it/s] 31%|â–ˆâ–ˆâ–ˆ       | 309/1000 [00:08<00:17, 38.86it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 313/1000 [00:08<00:17, 38.32it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 317/1000 [00:08<00:18, 37.92it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 321/1000 [00:08<00:18, 37.42it/s] 32%|â–ˆâ–ˆâ–ˆâ–Ž      | 325/1000 [00:08<00:18, 37.31it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 329/1000 [00:08<00:18, 37.24it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 333/1000 [00:08<00:17, 37.18it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 337/1000 [00:08<00:17, 36.96it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 341/1000 [00:09<00:17, 36.97it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 345/1000 [00:09<00:17, 37.01it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 350/1000 [00:09<00:16, 39.54it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 354/1000 [00:09<00:16, 38.82it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 359/1000 [00:09<00:15, 41.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 364/1000 [00:09<00:15, 41.35it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 369/1000 [00:09<00:17, 36.04it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 373/1000 [00:09<00:17, 36.32it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 377/1000 [00:09<00:17, 36.52it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 381/1000 [00:10<00:16, 37.11it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 385/1000 [00:10<00:16, 37.13it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 389/1000 [00:10<00:16, 37.15it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 393/1000 [00:10<00:16, 37.16it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 397/1000 [00:10<00:16, 37.12it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 401/1000 [00:10<00:16, 37.13it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 405/1000 [00:10<00:16, 37.10it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 409/1000 [00:10<00:15, 37.12it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 414/1000 [00:10<00:14, 39.63it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 418/1000 [00:11<00:14, 38.86it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 422/1000 [00:11<00:15, 38.32it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 426/1000 [00:11<00:15, 37.93it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 430/1000 [00:11<00:15, 37.68it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 434/1000 [00:11<00:15, 37.47it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 438/1000 [00:11<00:15, 36.51it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 442/1000 [00:11<00:15, 36.62it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 446/1000 [00:11<00:15, 36.74it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 451/1000 [00:11<00:13, 39.44it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 456/1000 [00:12<00:13, 41.34it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 461/1000 [00:12<00:13, 39.83it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 466/1000 [00:12<00:13, 38.89it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 470/1000 [00:12<00:13, 38.39it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 475/1000 [00:12<00:13, 39.85it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 479/1000 [00:12<00:13, 39.07it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 483/1000 [00:12<00:13, 38.49it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 487/1000 [00:12<00:13, 38.07it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 491/1000 [00:12<00:13, 37.81it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 495/1000 [00:13<00:13, 37.60it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 499/1000 [00:13<00:13, 37.47it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 503/1000 [00:13<00:13, 37.35it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 507/1000 [00:13<00:13, 37.28it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 511/1000 [00:13<00:13, 37.22it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 515/1000 [00:13<00:13, 37.22it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 519/1000 [00:13<00:12, 37.18it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 523/1000 [00:13<00:12, 37.12it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 527/1000 [00:13<00:12, 37.14it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 531/1000 [00:14<00:12, 37.14it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 535/1000 [00:14<00:12, 37.12it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 539/1000 [00:14<00:12, 37.11it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 543/1000 [00:14<00:12, 37.13it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 547/1000 [00:14<00:12, 37.15it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 551/1000 [00:14<00:12, 37.07it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 555/1000 [00:14<00:11, 37.11it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 559/1000 [00:14<00:11, 37.11it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 564/1000 [00:14<00:11, 39.12it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 569/1000 [00:15<00:10, 40.95it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 574/1000 [00:15<00:10, 39.37it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 578/1000 [00:15<00:10, 38.73it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 582/1000 [00:15<00:10, 38.29it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 586/1000 [00:15<00:10, 37.94it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 590/1000 [00:15<00:10, 37.68it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 594/1000 [00:15<00:10, 37.50it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 598/1000 [00:15<00:10, 37.40it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 602/1000 [00:15<00:10, 37.33it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 606/1000 [00:16<00:10, 37.27it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 610/1000 [00:16<00:10, 37.21it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 614/1000 [00:16<00:10, 37.18it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 619/1000 [00:16<00:09, 39.76it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 623/1000 [00:16<00:09, 38.96it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 627/1000 [00:16<00:09, 38.42it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 631/1000 [00:16<00:09, 38.04it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 635/1000 [00:16<00:09, 37.78it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 639/1000 [00:16<00:09, 37.60it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 643/1000 [00:17<00:09, 37.45it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 649/1000 [00:17<00:08, 42.66it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 654/1000 [00:17<00:08, 40.72it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 659/1000 [00:17<00:08, 39.54it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 663/1000 [00:17<00:08, 38.90it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 667/1000 [00:17<00:08, 38.39it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 671/1000 [00:17<00:08, 37.99it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 675/1000 [00:17<00:08, 37.74it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 679/1000 [00:17<00:08, 37.58it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 683/1000 [00:18<00:08, 37.47it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 687/1000 [00:18<00:08, 37.36it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 691/1000 [00:18<00:08, 37.30it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 695/1000 [00:18<00:08, 37.23it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 699/1000 [00:18<00:08, 37.21it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 703/1000 [00:18<00:07, 37.20it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 707/1000 [00:18<00:07, 37.18it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 711/1000 [00:18<00:07, 37.16it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 715/1000 [00:18<00:07, 37.15it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 719/1000 [00:19<00:07, 37.14it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 723/1000 [00:19<00:07, 37.12it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 727/1000 [00:19<00:07, 37.10it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 731/1000 [00:19<00:07, 37.10it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 735/1000 [00:19<00:07, 37.12it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 739/1000 [00:19<00:07, 37.08it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 743/1000 [00:19<00:06, 37.06it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 747/1000 [00:19<00:06, 37.07it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 752/1000 [00:19<00:06, 39.80it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 756/1000 [00:19<00:06, 38.98it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 760/1000 [00:20<00:06, 38.40it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 764/1000 [00:20<00:06, 37.98it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 768/1000 [00:20<00:06, 37.71it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 772/1000 [00:20<00:06, 37.54it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 776/1000 [00:20<00:05, 37.39it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 780/1000 [00:20<00:05, 37.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 784/1000 [00:20<00:05, 37.24it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 788/1000 [00:20<00:05, 37.20it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 792/1000 [00:20<00:05, 37.16it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 796/1000 [00:21<00:05, 37.13it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 800/1000 [00:21<00:05, 37.12it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 804/1000 [00:21<00:05, 37.12it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 809/1000 [00:21<00:04, 39.52it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 813/1000 [00:21<00:04, 38.49it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 817/1000 [00:21<00:04, 37.99it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 821/1000 [00:21<00:04, 37.60it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 825/1000 [00:21<00:04, 37.33it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 829/1000 [00:21<00:04, 37.25it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 833/1000 [00:22<00:04, 37.20it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 837/1000 [00:22<00:04, 37.16it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 841/1000 [00:22<00:04, 37.15it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 845/1000 [00:22<00:04, 37.18it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 849/1000 [00:22<00:04, 37.15it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 853/1000 [00:22<00:03, 37.13it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 857/1000 [00:22<00:03, 37.13it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 861/1000 [00:22<00:03, 37.15it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 865/1000 [00:22<00:03, 37.15it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 869/1000 [00:23<00:03, 37.14it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 873/1000 [00:23<00:03, 37.12it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 877/1000 [00:23<00:03, 36.79it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 881/1000 [00:23<00:03, 35.56it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 885/1000 [00:23<00:03, 35.67it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 889/1000 [00:23<00:03, 36.87it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 893/1000 [00:23<00:02, 36.90it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 897/1000 [00:23<00:02, 36.95it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 901/1000 [00:23<00:02, 36.99it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 905/1000 [00:23<00:02, 37.01it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 909/1000 [00:24<00:02, 37.02it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 913/1000 [00:24<00:02, 37.04it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 917/1000 [00:24<00:02, 37.06it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 921/1000 [00:24<00:02, 37.08it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 925/1000 [00:24<00:02, 37.08it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 930/1000 [00:24<00:01, 39.76it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 934/1000 [00:24<00:01, 38.98it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 938/1000 [00:24<00:01, 38.44it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 942/1000 [00:24<00:01, 38.03it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 947/1000 [00:25<00:01, 40.32it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 952/1000 [00:25<00:01, 39.09it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 956/1000 [00:25<00:01, 38.51it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 960/1000 [00:25<00:01, 38.07it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 964/1000 [00:25<00:00, 37.76it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 968/1000 [00:25<00:00, 36.77it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 972/1000 [00:25<00:00, 36.85it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 976/1000 [00:25<00:00, 36.88it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 980/1000 [00:25<00:00, 36.96it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 984/1000 [00:26<00:00, 37.22it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 988/1000 [00:26<00:00, 37.17it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 993/1000 [00:26<00:00, 39.83it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 997/1000 [00:26<00:00, 38.98it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:26<00:00, 37.77it/s][[36m2024-09-27 07:46:47,617[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - train Dataset already processed[0m
[[36m2024-09-27 07:46:47,618[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Processing val dataset before training[0m
[[36m2024-09-27 07:46:47,713[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Shape of processed val data: {'cancer_volume': (1000, 60), 'chemo_dosage': (1000, 60), 'radio_dosage': (1000, 60), 'chemo_application': (1000, 60), 'radio_application': (1000, 60), 'chemo_probabilities': (1000, 60), 'radio_probabilities': (1000, 60), 'sequence_lengths': (1000,), 'death_flags': (1000, 60), 'recovery_flags': (1000, 60), 'patient_types': (1000,), 'prev_treatments': (1000, 59, 4), 'current_treatments': (1000, 59, 4), 'current_covariates': (1000, 59, 2), 'outputs': (1000, 59, 1), 'active_entries': (1000, 59, 1), 'unscaled_outputs': (1000, 59, 1), 'prev_outputs': (1000, 59, 1), 'static_features': (1000, 1)}[0m
[[36m2024-09-27 07:46:47,713[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Processing test dataset before training[0m
[[36m2024-09-27 07:47:07,387[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Shape of processed test data: {'cancer_volume': (219908, 60), 'chemo_application': (219908, 60), 'radio_application': (219908, 60), 'sequence_lengths': (219908,), 'patient_types': (219908,), 'prev_treatments': (219908, 59, 4), 'current_treatments': (219908, 59, 4), 'current_covariates': (219908, 59, 2), 'outputs': (219908, 59, 1), 'active_entries': (219908, 59, 1), 'unscaled_outputs': (219908, 59, 1), 'prev_outputs': (219908, 59, 1), 'static_features': (219908, 1)}[0m
[[36m2024-09-27 07:47:07,706[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f342c887880>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m
[[36m2024-09-27 07:47:12,282[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f342c887040>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m
[[36m2024-09-27 07:47:20,721[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f342c887970>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m
[[36m2024-09-27 07:47:37,316[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f342c887610>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m
[[36m2024-09-27 07:48:09,556[0m][[34murllib3.connectionpool[0m][[33mWARNING[0m] - Retrying (Retry(total=0, connect=0, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f340ed9fc10>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator[0m

Error executing job with overrides: ['+dataset=cancer_sim', '+backbone=crn', "+backbone/crn_hparams/cancer_sim_subgroup_random='4'", 'exp.seed=10']
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connection.py", line 196, in _new_conn
    sock = connection.create_connection(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 495, in _make_request
    conn.request(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connection.py", line 398, in request
    self.endheaders()
  File "/usr/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connection.py", line 236, in connect
    self.sock = self._new_conn()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connection.py", line 211, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f340ed9f0a0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 873, in urlopen
    return self.urlopen(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 873, in urlopen
    return self.urlopen(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 873, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f340ed9f0a0>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 187, in http_request
    return _get_http_response_with_retries(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/request_utils.py", line 237, in _get_http_response_with_retries
    return session.request(method, url, allow_redirects=allow_redirects, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f340ed9f0a0>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "runnables/train_enc_dec.py", line 54, in main
    artifacts_path = hydra.utils.to_absolute_path(mlf_logger.experiment.get_run(mlf_logger.run_id).info.artifact_uri)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/loggers/base.py", line 42, in experiment
    return get_experiment() or DummyExperiment()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py", line 48, in wrapped_fn
    return fn(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/loggers/base.py", line 40, in get_experiment
    return fn(self)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/loggers/mlflow.py", line 152, in experiment
    expt = self._mlflow_client.get_experiment_by_name(self._experiment_name)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/tracking/client.py", line 1240, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 484, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 518, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 81, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 357, in call_endpoint
    response = http_request(**call_kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 210, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://127.0.0.1:5000/api/2.0/mlflow/experiments/get-by-name failed with exception HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=CRN%2Ftumor_generator (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f340ed9f0a0>: Failed to establish a new connection: [Errno 111] Connection refused'))

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
/var/spool/slurmd/job13720/slurm_script: line 20: exp.mlflow_uri=http://127.0.0.1:8004: No such file or directory
