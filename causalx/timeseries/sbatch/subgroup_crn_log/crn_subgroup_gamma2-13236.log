[2024-09-24 00:42:29 +0000] [2172836] [INFO] Starting gunicorn 22.0.0
[2024-09-24 00:42:29 +0000] [2172836] [INFO] Listening at: http://127.0.0.1:5000 (2172836)
[2024-09-24 00:42:29 +0000] [2172836] [INFO] Using worker: sync
[2024-09-24 00:42:29 +0000] [2172838] [INFO] Booting worker with pid: 2172838
[2024-09-24 00:42:29 +0000] [2172839] [INFO] Booting worker with pid: 2172839
[2024-09-24 00:42:29 +0000] [2172840] [INFO] Booting worker with pid: 2172840
[2024-09-24 00:42:29 +0000] [2172841] [INFO] Booting worker with pid: 2172841
runnables/train_enc_dec.py:18: UserWarning: 
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
  @hydra.main(config_name=f'config.yaml', config_path='../config/')
[[36m2024-09-24 00:42:56,330[0m][[34m__main__[0m][[32mINFO[0m] - 
model:
  dim_treatments: 4
  dim_vitals: 0
  dim_static_features: 1
  dim_outcomes: 1
  name: CRN
  encoder:
    _target_: src.models.crn.CRNEncoder
    seq_hidden_units: 24
    br_size: 24
    fc_hidden_units: 96
    dropout_rate: 0.2
    num_layer: 1
    batch_size: 1024
    optimizer:
      optimizer_cls: adam
      learning_rate: 0.005
      weight_decay: 0.0
      lr_scheduler: false
    tune_hparams: false
    tune_range: 50
    hparams_grid: null
    resources_per_trial: null
  train_decoder: true
  decoder:
    _target_: src.models.crn.CRNDecoder
    seq_hidden_units: null
    br_size: 24
    fc_hidden_units: 12
    dropout_rate: 0.1
    num_layer: 1
    batch_size: 4096
    optimizer:
      optimizer_cls: adam
      learning_rate: 0.01
      weight_decay: 0.0
      lr_scheduler: false
    tune_hparams: false
    tune_range: 30
    hparams_grid: null
    resources_per_trial: null
dataset:
  val_batch_size: 512
  treatment_mode: multiclass
  _target_: src.data.SyntheticCancerDatasetCollection
  name: tumor_generator
  coeff: 2.0
  chemo_coeff: 2.0
  radio_coeff: 2.0
  seed: 10
  num_patients:
    train: 10000
    val: 1000
    test: 1000
  window_size: 15
  lag: 0
  max_seq_length: 60
  projection_horizon: 5
  cf_seq_mode: sliding_treatment
exp:
  seed: 10
  gpus:
  - 0
  max_epochs: 200
  logging: true
  mlflow_uri: http://127.0.0.1:5000
  unscale_rmse: true
  percentage_rmse: true
  alpha: 0
  update_alpha: true
  alpha_rate: exp
  balancing: subgroup
  bce_weight: false
  weights_ema: true
  beta: 0.99
  alpha_wass: 0.0001
  alpha_wass_epoch: false
  alpha_wass_growth: 0.001
  alpha_wass_max: 0.01
  num_timepoints: 59
[0m
/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/hydra/_internal/hydra.py:119: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/1.2/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  ret = run_job(
Global seed set to 10
[[36m2024-09-24 00:42:56,392[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-24 00:42:56,400[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-24 00:42:56,403[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-24 00:42:56,404[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-24 00:42:56,406[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-24 00:42:56,451[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 4658 patients[0m
[[36m2024-09-24 00:42:56,456[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 9338 patients[0m
[[36m2024-09-24 00:42:56,460[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 13912 patients[0m
[[36m2024-09-24 00:42:56,468[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-24 00:42:56,474[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m
  0%|          | 0/10000 [00:00<?, ?it/s]/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer_avg/src/data/cancer_sim/cancer_simulation.py:346: RuntimeWarning: overflow encountered in exp
  if recovery_rvs[i, t] < np.exp(-cancer_volume[i, t] * TUMOUR_CELL_DENSITY):
  1%|          | 56/10000 [00:00<00:17, 559.60it/s]  1%|          | 117/10000 [00:00<00:16, 586.76it/s]  2%|â–         | 176/10000 [00:00<00:16, 585.86it/s]  2%|â–         | 235/10000 [00:00<00:16, 585.14it/s]  3%|â–Ž         | 294/10000 [00:00<00:16, 582.67it/s]  4%|â–Ž         | 353/10000 [00:00<00:16, 581.88it/s]  4%|â–         | 412/10000 [00:00<00:16, 583.78it/s]  5%|â–         | 473/10000 [00:00<00:16, 591.67it/s]  5%|â–Œ         | 533/10000 [00:00<00:16, 584.42it/s]  6%|â–Œ         | 592/10000 [00:01<00:16, 581.92it/s]  7%|â–‹         | 651/10000 [00:01<00:16, 578.50it/s]  7%|â–‹         | 709/10000 [00:01<00:16, 575.92it/s]  8%|â–Š         | 768/10000 [00:01<00:15, 578.44it/s]  8%|â–Š         | 826/10000 [00:01<00:15, 575.72it/s]  9%|â–‰         | 884/10000 [00:01<00:15, 575.53it/s]  9%|â–‰         | 944/10000 [00:01<00:15, 580.62it/s] 10%|â–ˆ         | 1003/10000 [00:01<00:15, 576.96it/s] 11%|â–ˆ         | 1062/10000 [00:01<00:15, 580.49it/s] 11%|â–ˆ         | 1121/10000 [00:01<00:15, 576.87it/s] 12%|â–ˆâ–        | 1180/10000 [00:02<00:15, 579.77it/s] 12%|â–ˆâ–        | 1238/10000 [00:02<00:15, 577.19it/s] 13%|â–ˆâ–Ž        | 1297/10000 [00:02<00:15, 578.74it/s] 14%|â–ˆâ–Ž        | 1355/10000 [00:02<00:15, 574.74it/s] 14%|â–ˆâ–        | 1413/10000 [00:02<00:14, 574.84it/s] 15%|â–ˆâ–        | 1471/10000 [00:02<00:14, 572.80it/s] 15%|â–ˆâ–Œ        | 1532/10000 [00:02<00:14, 582.55it/s] 16%|â–ˆâ–Œ        | 1593/10000 [00:02<00:14, 589.84it/s] 17%|â–ˆâ–‹        | 1652/10000 [00:02<00:14, 581.51it/s] 17%|â–ˆâ–‹        | 1711/10000 [00:02<00:14, 577.97it/s] 18%|â–ˆâ–Š        | 1774/10000 [00:03<00:13, 592.94it/s] 18%|â–ˆâ–Š        | 1834/10000 [00:03<00:13, 586.32it/s] 19%|â–ˆâ–‰        | 1893/10000 [00:03<00:13, 584.23it/s] 20%|â–ˆâ–‰        | 1953/10000 [00:03<00:13, 587.34it/s] 20%|â–ˆâ–ˆ        | 2013/10000 [00:03<00:13, 588.17it/s] 21%|â–ˆâ–ˆ        | 2072/10000 [00:03<00:13, 582.90it/s] 21%|â–ˆâ–ˆâ–       | 2131/10000 [00:03<00:13, 582.13it/s] 22%|â–ˆâ–ˆâ–       | 2192/10000 [00:03<00:13, 589.32it/s] 23%|â–ˆâ–ˆâ–Ž       | 2251/10000 [00:03<00:13, 582.51it/s] 23%|â–ˆâ–ˆâ–Ž       | 2310/10000 [00:03<00:13, 584.13it/s] 24%|â–ˆâ–ˆâ–Ž       | 2369/10000 [00:04<00:13, 577.39it/s] 24%|â–ˆâ–ˆâ–       | 2431/10000 [00:04<00:12, 588.67it/s] 25%|â–ˆâ–ˆâ–       | 2492/10000 [00:04<00:12, 592.37it/s] 26%|â–ˆâ–ˆâ–Œ       | 2552/10000 [00:04<00:12, 585.43it/s] 26%|â–ˆâ–ˆâ–Œ       | 2613/10000 [00:04<00:12, 591.18it/s] 27%|â–ˆâ–ˆâ–‹       | 2673/10000 [00:04<00:12, 587.72it/s] 27%|â–ˆâ–ˆâ–‹       | 2736/10000 [00:04<00:12, 597.52it/s] 28%|â–ˆâ–ˆâ–Š       | 2796/10000 [00:04<00:12, 590.41it/s] 29%|â–ˆâ–ˆâ–Š       | 2858/10000 [00:04<00:11, 596.82it/s] 29%|â–ˆâ–ˆâ–‰       | 2918/10000 [00:04<00:12, 589.56it/s] 30%|â–ˆâ–ˆâ–‰       | 2977/10000 [00:05<00:12, 583.22it/s] 30%|â–ˆâ–ˆâ–ˆ       | 3036/10000 [00:05<00:11, 584.40it/s] 31%|â–ˆâ–ˆâ–ˆ       | 3096/10000 [00:05<00:11, 586.13it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 3155/10000 [00:05<00:11, 583.64it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 3214/10000 [00:05<00:11, 583.24it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3274/10000 [00:05<00:11, 586.01it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3333/10000 [00:05<00:11, 585.95it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 3393/10000 [00:05<00:11, 587.37it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 3452/10000 [00:05<00:11, 583.06it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 3511/10000 [00:06<00:11, 579.61it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 3573/10000 [00:06<00:10, 588.85it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 3633/10000 [00:06<00:10, 589.97it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 3693/10000 [00:06<00:10, 588.66it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 3752/10000 [00:06<00:10, 588.12it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 3811/10000 [00:06<00:10, 580.99it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 3872/10000 [00:06<00:10, 588.12it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 3931/10000 [00:06<00:10, 586.22it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 3990/10000 [00:06<00:10, 581.93it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4049/10000 [00:06<00:10, 577.76it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4107/10000 [00:07<00:10, 573.04it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4165/10000 [00:07<00:10, 574.98it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4223/10000 [00:07<00:10, 576.06it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 4281/10000 [00:07<00:09, 576.96it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 4339/10000 [00:07<00:09, 574.48it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4397/10000 [00:07<00:09, 575.19it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4455/10000 [00:07<00:09, 573.01it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 4515/10000 [00:07<00:09, 579.24it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 4573/10000 [00:07<00:09, 576.78it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 4631/10000 [00:07<00:09, 574.17it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 4689/10000 [00:08<00:09, 574.60it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 4747/10000 [00:08<00:09, 570.11it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 4808/10000 [00:08<00:08, 580.49it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 4869/10000 [00:08<00:08, 586.99it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 4928/10000 [00:08<00:08, 579.91it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 4987/10000 [00:08<00:08, 575.57it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5045/10000 [00:08<00:08, 570.00it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5104/10000 [00:08<00:08, 573.48it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5162/10000 [00:08<00:08, 571.79it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5224/10000 [00:08<00:08, 585.32it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 5283/10000 [00:09<00:08, 580.76it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 5343/10000 [00:09<00:07, 585.12it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5405/10000 [00:09<00:07, 593.21it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 5466/10000 [00:09<00:07, 596.65it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5526/10000 [00:09<00:07, 595.62it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5586/10000 [00:09<00:07, 595.28it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 5646/10000 [00:09<00:07, 594.94it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 5708/10000 [00:09<00:07, 600.08it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 5769/10000 [00:09<00:07, 596.30it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 5829/10000 [00:09<00:07, 595.48it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 5890/10000 [00:10<00:06, 596.68it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 5950/10000 [00:10<00:06, 590.84it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6010/10000 [00:10<00:06, 584.37it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6069/10000 [00:10<00:06, 583.78it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6128/10000 [00:10<00:06, 583.67it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6187/10000 [00:10<00:06, 582.41it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6248/10000 [00:10<00:06, 588.22it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 6307/10000 [00:10<00:06, 582.15it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 6368/10000 [00:10<00:06, 588.05it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6427/10000 [00:11<00:06, 587.23it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 6486/10000 [00:11<00:06, 581.07it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 6546/10000 [00:11<00:05, 585.60it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 6605/10000 [00:11<00:05, 579.06it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6663/10000 [00:11<00:05, 573.67it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6721/10000 [00:11<00:05, 575.21it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 6782/10000 [00:11<00:05, 583.78it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 6841/10000 [00:11<00:05, 577.24it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 6899/10000 [00:11<00:05, 576.59it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 6957/10000 [00:11<00:05, 575.88it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7015/10000 [00:12<00:05, 576.76it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7075/10000 [00:12<00:05, 583.46it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7134/10000 [00:12<00:04, 584.14it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7194/10000 [00:12<00:04, 588.71it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 7253/10000 [00:12<00:04, 585.00it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 7312/10000 [00:12<00:04, 581.97it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 7372/10000 [00:12<00:04, 584.51it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7432/10000 [00:12<00:04, 586.30it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 7491/10000 [00:12<00:04, 579.89it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 7550/10000 [00:12<00:04, 577.69it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 7609/10000 [00:13<00:04, 581.08it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 7669/10000 [00:13<00:03, 584.16it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 7728/10000 [00:13<00:03, 582.22it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7787/10000 [00:13<00:03, 579.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7849/10000 [00:13<00:03, 588.97it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 7908/10000 [00:13<00:03, 587.97it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 7967/10000 [00:13<00:03, 584.04it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8026/10000 [00:13<00:03, 581.54it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8085/10000 [00:13<00:03, 575.33it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8143/10000 [00:13<00:03, 575.19it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8201/10000 [00:14<00:03, 575.10it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 8260/10000 [00:14<00:03, 577.32it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 8319/10000 [00:14<00:02, 580.99it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8378/10000 [00:14<00:02, 576.95it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8436/10000 [00:14<00:02, 576.29it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 8494/10000 [00:14<00:02, 572.59it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 8552/10000 [00:14<00:02, 571.44it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 8613/10000 [00:14<00:02, 579.87it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 8671/10000 [00:14<00:02, 579.74it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 8729/10000 [00:14<00:02, 577.89it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 8787/10000 [00:15<00:02, 577.74it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 8846/10000 [00:15<00:01, 578.93it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8905/10000 [00:15<00:01, 582.14it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8965/10000 [00:15<00:01, 585.27it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9024/10000 [00:15<00:01, 577.84it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9083/10000 [00:15<00:01, 578.64it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9144/10000 [00:15<00:01, 587.36it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9203/10000 [00:15<00:01, 580.48it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 9262/10000 [00:15<00:01, 575.71it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 9321/10000 [00:16<00:01, 579.40it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9380/10000 [00:16<00:01, 582.03it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 9439/10000 [00:16<00:00, 575.01it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 9500/10000 [00:16<00:00, 582.75it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 9559/10000 [00:16<00:00, 581.82it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 9618/10000 [00:16<00:00, 578.57it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 9676/10000 [00:16<00:00, 574.02it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 9734/10000 [00:16<00:00, 571.55it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 9792/10000 [00:16<00:00, 571.35it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 9850/10000 [00:16<00:00, 570.62it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 9909/10000 [00:17<00:00, 573.75it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 9968/10000 [00:17<00:00, 578.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10000/10000 [00:17<00:00, 581.96it/s][[36m2024-09-24 00:43:13,706[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-24 00:43:13,710[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-24 00:43:13,711[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-24 00:43:13,711[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-24 00:43:13,712[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-24 00:43:13,714[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 464 patients[0m
[[36m2024-09-24 00:43:13,715[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 942 patients[0m
[[36m2024-09-24 00:43:13,716[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 1398 patients[0m
[[36m2024-09-24 00:43:13,717[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-24 00:43:13,719[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m

  0%|          | 0/1000 [00:00<?, ?it/s]  6%|â–Œ         | 60/1000 [00:00<00:01, 591.36it/s] 12%|â–ˆâ–        | 120/1000 [00:00<00:01, 586.75it/s] 18%|â–ˆâ–Š        | 179/1000 [00:00<00:01, 582.80it/s] 24%|â–ˆâ–ˆâ–       | 240/1000 [00:00<00:01, 592.79it/s] 30%|â–ˆâ–ˆâ–ˆ       | 300/1000 [00:00<00:01, 584.53it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 359/1000 [00:00<00:01, 584.14it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 418/1000 [00:00<00:00, 584.55it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 477/1000 [00:00<00:00, 585.50it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 536/1000 [00:00<00:00, 581.86it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 596/1000 [00:01<00:00, 586.32it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 656/1000 [00:01<00:00, 589.11it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 715/1000 [00:01<00:00, 585.96it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 774/1000 [00:01<00:00, 581.60it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 833/1000 [00:01<00:00, 580.85it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 892/1000 [00:01<00:00, 578.32it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 950/1000 [00:01<00:00, 577.76it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:01<00:00, 583.11it/s][[36m2024-09-24 00:43:15,442[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-24 00:43:15,443[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-24 00:43:15,443[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-24 00:43:15,444[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-24 00:43:15,445[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-24 00:43:15,446[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 491 patients[0m
[[36m2024-09-24 00:43:15,447[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 936 patients[0m
[[36m2024-09-24 00:43:15,448[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 1396 patients[0m
[[36m2024-09-24 00:43:15,449[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-24 00:43:15,450[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m

  0%|          | 0/1000 [00:00<?, ?it/s]  1%|â–         | 13/1000 [00:00<00:07, 124.57it/s]  3%|â–Ž         | 27/1000 [00:00<00:07, 130.44it/s]  4%|â–         | 41/1000 [00:00<00:07, 132.11it/s]  6%|â–Œ         | 56/1000 [00:00<00:06, 135.11it/s]  7%|â–‹         | 70/1000 [00:00<00:06, 136.65it/s]  8%|â–Š         | 84/1000 [00:00<00:07, 130.32it/s] 10%|â–‰         | 98/1000 [00:00<00:06, 130.22it/s] 11%|â–ˆ         | 112/1000 [00:00<00:06, 130.26it/s] 13%|â–ˆâ–Ž        | 126/1000 [00:00<00:06, 130.95it/s] 14%|â–ˆâ–        | 140/1000 [00:01<00:06, 126.85it/s] 15%|â–ˆâ–Œ        | 153/1000 [00:01<00:06, 125.19it/s] 17%|â–ˆâ–‹        | 167/1000 [00:01<00:06, 127.12it/s] 18%|â–ˆâ–Š        | 180/1000 [00:01<00:06, 124.20it/s] 19%|â–ˆâ–‰        | 193/1000 [00:01<00:06, 125.39it/s] 21%|â–ˆâ–ˆ        | 209/1000 [00:01<00:05, 132.53it/s] 22%|â–ˆâ–ˆâ–       | 224/1000 [00:01<00:05, 134.95it/s] 24%|â–ˆâ–ˆâ–       | 239/1000 [00:01<00:05, 137.67it/s] 25%|â–ˆâ–ˆâ–Œ       | 253/1000 [00:01<00:05, 131.69it/s] 27%|â–ˆâ–ˆâ–‹       | 267/1000 [00:02<00:05, 130.11it/s] 28%|â–ˆâ–ˆâ–Š       | 281/1000 [00:02<00:05, 132.23it/s] 30%|â–ˆâ–ˆâ–‰       | 295/1000 [00:02<00:05, 127.98it/s] 31%|â–ˆâ–ˆâ–ˆ       | 308/1000 [00:02<00:05, 126.65it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 321/1000 [00:02<00:05, 125.18it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 334/1000 [00:02<00:05, 123.27it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 347/1000 [00:02<00:05, 121.90it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 360/1000 [00:02<00:05, 120.97it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 373/1000 [00:02<00:05, 120.10it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 386/1000 [00:03<00:05, 119.68it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 398/1000 [00:03<00:05, 119.66it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 410/1000 [00:03<00:04, 119.36it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 422/1000 [00:03<00:04, 119.40it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 435/1000 [00:03<00:04, 121.94it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 448/1000 [00:03<00:04, 120.95it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 461/1000 [00:03<00:04, 120.17it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 475/1000 [00:03<00:04, 122.90it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 489/1000 [00:03<00:04, 126.98it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 502/1000 [00:03<00:04, 124.25it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 515/1000 [00:04<00:03, 122.54it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 529/1000 [00:04<00:03, 125.39it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 542/1000 [00:04<00:03, 123.40it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 555/1000 [00:04<00:03, 122.61it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 569/1000 [00:04<00:03, 126.96it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 582/1000 [00:04<00:03, 124.47it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 595/1000 [00:04<00:03, 122.73it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 608/1000 [00:04<00:03, 121.49it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 621/1000 [00:04<00:03, 121.63it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 635/1000 [00:05<00:02, 125.90it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 648/1000 [00:05<00:02, 123.69it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 662/1000 [00:05<00:02, 126.11it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 675/1000 [00:05<00:02, 123.86it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 688/1000 [00:05<00:02, 125.10it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 701/1000 [00:05<00:02, 123.66it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 714/1000 [00:05<00:02, 124.93it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 727/1000 [00:05<00:02, 123.05it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 740/1000 [00:05<00:02, 124.09it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 753/1000 [00:06<00:02, 122.47it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 766/1000 [00:06<00:01, 121.80it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 779/1000 [00:06<00:01, 121.10it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 792/1000 [00:06<00:01, 122.75it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 805/1000 [00:06<00:01, 121.54it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 818/1000 [00:06<00:01, 120.67it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 831/1000 [00:06<00:01, 122.41it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 844/1000 [00:06<00:01, 124.12it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 857/1000 [00:06<00:01, 124.04it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 870/1000 [00:06<00:01, 122.74it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 883/1000 [00:07<00:01, 110.42it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 895/1000 [00:07<00:00, 112.64it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 908/1000 [00:07<00:00, 115.19it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 920/1000 [00:07<00:00, 116.24it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 933/1000 [00:07<00:00, 118.51it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 945/1000 [00:07<00:00, 118.84it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 957/1000 [00:07<00:00, 118.79it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 970/1000 [00:07<00:00, 120.23it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 983/1000 [00:07<00:00, 122.41it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 996/1000 [00:08<00:00, 124.49it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:08<00:00, 124.09it/s]Call to simulate counterfactuals data
[[36m2024-09-24 00:43:23,512[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528[0m
[[36m2024-09-24 00:43:23,513[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772[0m
[[36m2024-09-24 00:43:23,514[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796[0m
[[36m2024-09-24 00:43:23,514[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155[0m
[[36m2024-09-24 00:43:23,515[0m][[34mroot[0m][[32mINFO[0m] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307[0m
[[36m2024-09-24 00:43:23,517[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 434 patients[0m
[[36m2024-09-24 00:43:23,518[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 874 patients[0m
[[36m2024-09-24 00:43:23,519[0m][[34mroot[0m][[32mINFO[0m] - Got correlated params for 1357 patients[0m
[[36m2024-09-24 00:43:23,520[0m][[34mroot[0m][[32mINFO[0m] - Simulating beta_c parameters[0m
[[36m2024-09-24 00:43:23,521[0m][[34mroot[0m][[32mINFO[0m] - Randomising outputs[0m

  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 4/1000 [00:00<00:29, 33.71it/s]  1%|          | 8/1000 [00:00<00:29, 33.77it/s]  1%|          | 12/1000 [00:00<00:29, 33.77it/s]  2%|â–         | 16/1000 [00:00<00:27, 35.58it/s]  2%|â–         | 20/1000 [00:00<00:28, 34.84it/s]  2%|â–Ž         | 25/1000 [00:00<00:26, 37.28it/s]  3%|â–Ž         | 29/1000 [00:00<00:26, 36.01it/s]  3%|â–Ž         | 33/1000 [00:00<00:27, 35.25it/s]  4%|â–         | 38/1000 [00:01<00:26, 36.99it/s]  4%|â–         | 43/1000 [00:01<00:24, 38.53it/s]  5%|â–         | 48/1000 [00:01<00:24, 38.69it/s]  5%|â–Œ         | 52/1000 [00:01<00:25, 37.22it/s]  6%|â–Œ         | 56/1000 [00:01<00:26, 36.15it/s]  6%|â–Œ         | 60/1000 [00:01<00:26, 35.43it/s]  6%|â–‹         | 64/1000 [00:01<00:26, 34.83it/s]  7%|â–‹         | 68/1000 [00:01<00:28, 33.12it/s]  7%|â–‹         | 72/1000 [00:02<00:27, 33.49it/s]  8%|â–Š         | 76/1000 [00:02<00:27, 33.56it/s]  8%|â–Š         | 81/1000 [00:02<00:25, 36.07it/s]  8%|â–Š         | 85/1000 [00:02<00:25, 35.39it/s]  9%|â–‰         | 89/1000 [00:02<00:26, 34.91it/s]  9%|â–‰         | 93/1000 [00:02<00:26, 34.60it/s] 10%|â–‰         | 97/1000 [00:02<00:26, 34.35it/s] 10%|â–ˆ         | 101/1000 [00:02<00:26, 34.12it/s] 10%|â–ˆ         | 105/1000 [00:02<00:26, 34.01it/s] 11%|â–ˆ         | 109/1000 [00:03<00:26, 33.64it/s] 11%|â–ˆâ–        | 113/1000 [00:03<00:26, 33.67it/s] 12%|â–ˆâ–        | 117/1000 [00:03<00:26, 33.70it/s] 12%|â–ˆâ–        | 121/1000 [00:03<00:26, 33.73it/s] 12%|â–ˆâ–Ž        | 125/1000 [00:03<00:25, 33.92it/s] 13%|â–ˆâ–Ž        | 129/1000 [00:03<00:25, 33.88it/s] 13%|â–ˆâ–Ž        | 133/1000 [00:03<00:25, 33.79it/s] 14%|â–ˆâ–Ž        | 137/1000 [00:03<00:25, 33.77it/s] 14%|â–ˆâ–        | 141/1000 [00:04<00:24, 34.86it/s]/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer_avg/src/data/cancer_sim/cancer_simulation.py:734: RuntimeWarning: invalid value encountered in log
  (1 + rho * np.log(K / (counterfactual_cancer_volume[current_t] + 1e-07) + 1e-07) -
 15%|â–ˆâ–        | 146/1000 [00:04<00:23, 36.67it/s] 15%|â–ˆâ–Œ        | 150/1000 [00:04<00:23, 36.62it/s] 15%|â–ˆâ–Œ        | 154/1000 [00:04<00:23, 35.75it/s] 16%|â–ˆâ–Œ        | 158/1000 [00:04<00:23, 35.14it/s] 16%|â–ˆâ–Œ        | 162/1000 [00:04<00:24, 34.71it/s] 17%|â–ˆâ–‹        | 166/1000 [00:04<00:24, 34.41it/s] 17%|â–ˆâ–‹        | 170/1000 [00:04<00:24, 34.15it/s] 17%|â–ˆâ–‹        | 174/1000 [00:04<00:24, 34.00it/s] 18%|â–ˆâ–Š        | 178/1000 [00:05<00:24, 33.91it/s] 18%|â–ˆâ–Š        | 182/1000 [00:05<00:24, 33.85it/s] 19%|â–ˆâ–Š        | 186/1000 [00:05<00:24, 33.80it/s] 19%|â–ˆâ–‰        | 190/1000 [00:05<00:23, 33.77it/s] 19%|â–ˆâ–‰        | 194/1000 [00:05<00:23, 33.76it/s] 20%|â–ˆâ–‰        | 198/1000 [00:05<00:23, 33.76it/s] 20%|â–ˆâ–ˆ        | 202/1000 [00:05<00:23, 33.70it/s] 21%|â–ˆâ–ˆ        | 206/1000 [00:05<00:23, 33.71it/s] 21%|â–ˆâ–ˆ        | 211/1000 [00:06<00:21, 35.88it/s] 22%|â–ˆâ–ˆâ–       | 215/1000 [00:06<00:22, 35.27it/s] 22%|â–ˆâ–ˆâ–       | 219/1000 [00:06<00:22, 34.84it/s] 22%|â–ˆâ–ˆâ–       | 223/1000 [00:06<00:22, 34.52it/s] 23%|â–ˆâ–ˆâ–Ž       | 228/1000 [00:06<00:21, 36.73it/s] 23%|â–ˆâ–ˆâ–Ž       | 232/1000 [00:06<00:21, 35.84it/s] 24%|â–ˆâ–ˆâ–Ž       | 236/1000 [00:06<00:21, 35.21it/s] 24%|â–ˆâ–ˆâ–       | 240/1000 [00:06<00:21, 34.73it/s] 24%|â–ˆâ–ˆâ–       | 244/1000 [00:06<00:21, 35.47it/s] 25%|â–ˆâ–ˆâ–       | 249/1000 [00:07<00:20, 37.47it/s] 25%|â–ˆâ–ˆâ–Œ       | 253/1000 [00:07<00:20, 37.16it/s] 26%|â–ˆâ–ˆâ–Œ       | 257/1000 [00:07<00:20, 36.12it/s] 26%|â–ˆâ–ˆâ–Œ       | 261/1000 [00:07<00:20, 35.45it/s] 26%|â–ˆâ–ˆâ–‹       | 265/1000 [00:07<00:21, 34.94it/s] 27%|â–ˆâ–ˆâ–‹       | 269/1000 [00:07<00:21, 34.59it/s] 27%|â–ˆâ–ˆâ–‹       | 274/1000 [00:07<00:19, 36.60it/s] 28%|â–ˆâ–ˆâ–Š       | 278/1000 [00:07<00:19, 36.35it/s] 28%|â–ˆâ–ˆâ–Š       | 282/1000 [00:08<00:20, 35.52it/s] 29%|â–ˆâ–ˆâ–Š       | 286/1000 [00:08<00:20, 35.00it/s] 29%|â–ˆâ–ˆâ–‰       | 290/1000 [00:08<00:20, 34.63it/s] 29%|â–ˆâ–ˆâ–‰       | 294/1000 [00:08<00:20, 34.36it/s] 30%|â–ˆâ–ˆâ–‰       | 298/1000 [00:08<00:20, 34.17it/s] 30%|â–ˆâ–ˆâ–ˆ       | 303/1000 [00:08<00:19, 36.44it/s] 31%|â–ˆâ–ˆâ–ˆ       | 307/1000 [00:08<00:18, 36.76it/s] 31%|â–ˆâ–ˆâ–ˆ       | 311/1000 [00:08<00:19, 35.79it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 315/1000 [00:08<00:19, 35.15it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 320/1000 [00:09<00:18, 37.19it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 324/1000 [00:09<00:18, 36.91it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 329/1000 [00:09<00:17, 38.49it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 333/1000 [00:09<00:17, 37.07it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 337/1000 [00:09<00:18, 36.33it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 341/1000 [00:09<00:18, 35.56it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 345/1000 [00:09<00:18, 34.97it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 349/1000 [00:09<00:18, 34.59it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 353/1000 [00:10<00:18, 34.31it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 357/1000 [00:10<00:18, 34.92it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 361/1000 [00:10<00:18, 34.57it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 365/1000 [00:10<00:18, 34.29it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 369/1000 [00:10<00:18, 34.11it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 373/1000 [00:10<00:18, 33.97it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 377/1000 [00:10<00:18, 33.89it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 381/1000 [00:10<00:23, 26.09it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 385/1000 [00:11<00:21, 27.98it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 389/1000 [00:11<00:20, 29.49it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 393/1000 [00:11<00:19, 30.64it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 397/1000 [00:11<00:19, 31.50it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 401/1000 [00:11<00:18, 32.15it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 405/1000 [00:11<00:18, 32.59it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 409/1000 [00:11<00:17, 32.87it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 413/1000 [00:11<00:17, 33.11it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 417/1000 [00:12<00:17, 33.27it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 421/1000 [00:12<00:17, 33.42it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 425/1000 [00:12<00:17, 32.94it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 429/1000 [00:12<00:17, 33.16it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 433/1000 [00:12<00:17, 33.33it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 437/1000 [00:12<00:16, 33.46it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 441/1000 [00:12<00:16, 33.55it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 445/1000 [00:12<00:16, 33.56it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 450/1000 [00:13<00:15, 35.96it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 454/1000 [00:13<00:15, 35.30it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 458/1000 [00:13<00:15, 34.84it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 462/1000 [00:13<00:15, 34.52it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 466/1000 [00:13<00:15, 35.39it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 470/1000 [00:13<00:15, 34.87it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 474/1000 [00:13<00:15, 34.53it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 478/1000 [00:13<00:15, 34.22it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 482/1000 [00:13<00:15, 34.06it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 486/1000 [00:14<00:15, 33.95it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 490/1000 [00:14<00:15, 33.64it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 494/1000 [00:14<00:15, 33.66it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 498/1000 [00:14<00:14, 33.69it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 502/1000 [00:14<00:14, 33.71it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 506/1000 [00:14<00:14, 33.71it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 510/1000 [00:14<00:13, 35.01it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 515/1000 [00:14<00:13, 37.00it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 519/1000 [00:14<00:13, 36.61it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 524/1000 [00:15<00:12, 38.16it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 528/1000 [00:15<00:12, 36.82it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 532/1000 [00:15<00:13, 35.90it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 536/1000 [00:15<00:13, 35.25it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 540/1000 [00:15<00:13, 34.78it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 544/1000 [00:15<00:13, 34.49it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 548/1000 [00:15<00:13, 34.21it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 553/1000 [00:15<00:12, 36.32it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 557/1000 [00:16<00:12, 35.54it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 561/1000 [00:16<00:11, 36.71it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 565/1000 [00:16<00:12, 35.80it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 569/1000 [00:16<00:12, 35.18it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 573/1000 [00:16<00:12, 34.75it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 577/1000 [00:16<00:12, 34.45it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 582/1000 [00:16<00:11, 37.36it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 586/1000 [00:16<00:11, 36.20it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 590/1000 [00:16<00:11, 35.45it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 594/1000 [00:17<00:11, 34.94it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 598/1000 [00:17<00:11, 34.57it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 602/1000 [00:17<00:11, 34.32it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 606/1000 [00:17<00:11, 34.45it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 610/1000 [00:17<00:10, 35.79it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 615/1000 [00:17<00:09, 38.81it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 619/1000 [00:17<00:10, 37.18it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 624/1000 [00:17<00:09, 38.83it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 629/1000 [00:18<00:09, 39.70it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 633/1000 [00:18<00:09, 37.91it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 637/1000 [00:18<00:09, 36.66it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 641/1000 [00:18<00:09, 36.65it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 645/1000 [00:18<00:09, 35.77it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 649/1000 [00:18<00:09, 35.18it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 653/1000 [00:18<00:09, 34.75it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 657/1000 [00:18<00:09, 34.40it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 661/1000 [00:18<00:09, 34.20it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 666/1000 [00:19<00:08, 38.09it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 670/1000 [00:19<00:08, 36.77it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 674/1000 [00:19<00:09, 35.86it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 678/1000 [00:19<00:08, 36.89it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 683/1000 [00:19<00:08, 38.50it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 687/1000 [00:19<00:08, 37.06it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 691/1000 [00:19<00:08, 36.06it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 695/1000 [00:19<00:08, 35.29it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 701/1000 [00:20<00:07, 39.13it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 705/1000 [00:20<00:07, 37.53it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 709/1000 [00:20<00:07, 36.44it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 713/1000 [00:20<00:08, 35.64it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 717/1000 [00:20<00:08, 34.85it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 721/1000 [00:20<00:08, 34.53it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 725/1000 [00:20<00:07, 34.67it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 730/1000 [00:20<00:07, 36.73it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 734/1000 [00:20<00:07, 36.06it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 738/1000 [00:21<00:07, 34.22it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 742/1000 [00:21<00:07, 34.87it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 746/1000 [00:21<00:07, 34.54it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 750/1000 [00:21<00:07, 34.32it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 755/1000 [00:21<00:06, 37.76it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 760/1000 [00:21<00:06, 38.53it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 765/1000 [00:21<00:05, 39.51it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 769/1000 [00:21<00:06, 38.34it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 773/1000 [00:22<00:06, 36.95it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 777/1000 [00:22<00:06, 35.96it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 781/1000 [00:22<00:06, 35.29it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 786/1000 [00:22<00:05, 37.17it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 790/1000 [00:22<00:05, 36.16it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 794/1000 [00:22<00:05, 35.43it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 798/1000 [00:22<00:05, 34.93it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 803/1000 [00:22<00:05, 36.90it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 808/1000 [00:22<00:05, 38.28it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 812/1000 [00:23<00:05, 36.93it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 816/1000 [00:23<00:05, 35.99it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 820/1000 [00:23<00:05, 35.33it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 824/1000 [00:23<00:05, 34.87it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 828/1000 [00:23<00:04, 34.55it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 832/1000 [00:23<00:04, 35.44it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 837/1000 [00:23<00:04, 37.47it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 841/1000 [00:23<00:04, 36.26it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 845/1000 [00:24<00:04, 36.81it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 849/1000 [00:24<00:04, 35.85it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 853/1000 [00:24<00:04, 35.21it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 857/1000 [00:24<00:04, 34.77it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 861/1000 [00:24<00:03, 35.50it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 865/1000 [00:24<00:03, 34.94it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 871/1000 [00:24<00:03, 39.63it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 875/1000 [00:24<00:03, 37.79it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 880/1000 [00:24<00:03, 38.77it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 884/1000 [00:25<00:03, 37.26it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 888/1000 [00:25<00:03, 36.22it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 892/1000 [00:25<00:02, 37.05it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 896/1000 [00:25<00:02, 36.55it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 900/1000 [00:25<00:02, 36.79it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 905/1000 [00:25<00:02, 38.19it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 909/1000 [00:25<00:02, 37.74it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 913/1000 [00:25<00:02, 36.43it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 917/1000 [00:25<00:02, 35.58it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 921/1000 [00:26<00:02, 35.03it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 925/1000 [00:26<00:02, 34.82it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 929/1000 [00:26<00:02, 34.49it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 933/1000 [00:26<00:01, 34.27it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 938/1000 [00:26<00:01, 37.72it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 942/1000 [00:26<00:01, 36.83it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 946/1000 [00:26<00:01, 35.56it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 953/1000 [00:26<00:01, 42.12it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 958/1000 [00:27<00:01, 40.33it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 963/1000 [00:27<00:00, 38.11it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 967/1000 [00:27<00:00, 36.89it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 971/1000 [00:27<00:00, 36.93it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 976/1000 [00:27<00:00, 38.34it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 980/1000 [00:27<00:00, 37.27it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 985/1000 [00:27<00:00, 38.69it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 990/1000 [00:27<00:00, 39.62it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 994/1000 [00:28<00:00, 37.86it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 999/1000 [00:28<00:00, 39.69it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:28<00:00, 35.50it/s][[36m2024-09-24 00:43:52,067[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Processing train dataset before training[0m
[[36m2024-09-24 00:43:53,168[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Shape of processed train data: {'cancer_volume': (10000, 60), 'chemo_dosage': (10000, 60), 'radio_dosage': (10000, 60), 'chemo_application': (10000, 60), 'radio_application': (10000, 60), 'chemo_probabilities': (10000, 60), 'radio_probabilities': (10000, 60), 'sequence_lengths': (10000,), 'death_flags': (10000, 60), 'recovery_flags': (10000, 60), 'patient_types': (10000,), 'prev_treatments': (10000, 59, 4), 'current_treatments': (10000, 59, 4), 'current_covariates': (10000, 59, 2), 'outputs': (10000, 59, 1), 'active_entries': (10000, 59, 1), 'unscaled_outputs': (10000, 59, 1), 'prev_outputs': (10000, 59, 1), 'static_features': (10000, 1)}[0m
[[36m2024-09-24 00:43:53,169[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Processing val dataset before training[0m
[[36m2024-09-24 00:43:53,269[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Shape of processed val data: {'cancer_volume': (1000, 60), 'chemo_dosage': (1000, 60), 'radio_dosage': (1000, 60), 'chemo_application': (1000, 60), 'radio_application': (1000, 60), 'chemo_probabilities': (1000, 60), 'radio_probabilities': (1000, 60), 'sequence_lengths': (1000,), 'death_flags': (1000, 60), 'recovery_flags': (1000, 60), 'patient_types': (1000,), 'prev_treatments': (1000, 59, 4), 'current_treatments': (1000, 59, 4), 'current_covariates': (1000, 59, 2), 'outputs': (1000, 59, 1), 'active_entries': (1000, 59, 1), 'unscaled_outputs': (1000, 59, 1), 'prev_outputs': (1000, 59, 1), 'static_features': (1000, 1)}[0m
[[36m2024-09-24 00:43:53,269[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Processing test dataset before training[0m
[[36m2024-09-24 00:44:13,293[0m][[34msrc.data.cancer_sim.dataset[0m][[32mINFO[0m] - Shape of processed test data: {'cancer_volume': (224056, 60), 'chemo_application': (224056, 60), 'radio_application': (224056, 60), 'sequence_lengths': (224056,), 'patient_types': (224056,), 'prev_treatments': (224056, 59, 4), 'current_treatments': (224056, 59, 4), 'current_covariates': (224056, 59, 2), 'outputs': (224056, 59, 1), 'active_entries': (224056, 59, 1), 'unscaled_outputs': (224056, 59, 1), 'prev_outputs': (224056, 59, 1), 'static_features': (224056, 1)}[0m
2024/09/24 00:44:14 ERROR mlflow.server: Exception on /api/2.0/mlflow/runs/create [POST]
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 1473, in wsgi_app
    response = self.full_dispatch_request()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 882, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 566, in wrapper
    return func(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 607, in wrapper
    return func(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 775, in _create_run
    run = _get_tracking_store().create_run(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/file_store.py", line 662, in create_run
    mkdir(run_dir)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 211, in mkdir
    raise e
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 208, in mkdir
    os.makedirs(target, exist_ok=True)
  File "/usr/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: './mlruns/712563692599820190/d65f98252f7549708f186a695b380750'
2024/09/24 00:44:14 ERROR mlflow.server: Exception on /api/2.0/mlflow/runs/create [POST]
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 1473, in wsgi_app
    response = self.full_dispatch_request()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 882, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 566, in wrapper
    return func(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 607, in wrapper
    return func(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 775, in _create_run
    run = _get_tracking_store().create_run(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/file_store.py", line 662, in create_run
    mkdir(run_dir)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 211, in mkdir
    raise e
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 208, in mkdir
    os.makedirs(target, exist_ok=True)
  File "/usr/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: './mlruns/712563692599820190/5c9d8f0e48a74c4ba61cd93fa15d30f3'
2024/09/24 00:44:18 ERROR mlflow.server: Exception on /api/2.0/mlflow/runs/create [POST]
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 1473, in wsgi_app
    response = self.full_dispatch_request()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 882, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 566, in wrapper
    return func(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 607, in wrapper
    return func(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 775, in _create_run
    run = _get_tracking_store().create_run(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/file_store.py", line 662, in create_run
    mkdir(run_dir)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 211, in mkdir
    raise e
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 208, in mkdir
    os.makedirs(target, exist_ok=True)
  File "/usr/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: './mlruns/712563692599820190/3ad6c40955904c4fa7720a7c46595649'
2024/09/24 00:44:27 ERROR mlflow.server: Exception on /api/2.0/mlflow/runs/create [POST]
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 1473, in wsgi_app
    response = self.full_dispatch_request()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 882, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 566, in wrapper
    return func(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 607, in wrapper
    return func(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 775, in _create_run
    run = _get_tracking_store().create_run(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/file_store.py", line 662, in create_run
    mkdir(run_dir)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 211, in mkdir
    raise e
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 208, in mkdir
    os.makedirs(target, exist_ok=True)
  File "/usr/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: './mlruns/712563692599820190/1e31ebce3acc41279507f0981a0b4e98'
2024/09/24 00:44:43 ERROR mlflow.server: Exception on /api/2.0/mlflow/runs/create [POST]
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 1473, in wsgi_app
    response = self.full_dispatch_request()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 882, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 566, in wrapper
    return func(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 607, in wrapper
    return func(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 775, in _create_run
    run = _get_tracking_store().create_run(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/file_store.py", line 662, in create_run
    mkdir(run_dir)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 211, in mkdir
    raise e
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 208, in mkdir
    os.makedirs(target, exist_ok=True)
  File "/usr/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: './mlruns/712563692599820190/6da115bc637c4aefad6fa4fe9e7a3133'
2024/09/24 00:45:16 ERROR mlflow.server: Exception on /api/2.0/mlflow/runs/create [POST]
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 1473, in wsgi_app
    response = self.full_dispatch_request()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 882, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 566, in wrapper
    return func(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 607, in wrapper
    return func(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/server/handlers.py", line 775, in _create_run
    run = _get_tracking_store().create_run(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/file_store.py", line 662, in create_run
    mkdir(run_dir)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 211, in mkdir
    raise e
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 208, in mkdir
    os.makedirs(target, exist_ok=True)
  File "/usr/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: './mlruns/712563692599820190/dbda4f4239ab443780292983a0b678ea'

Error executing job with overrides: ['+dataset=cancer_sim', '+backbone=crn', "+backbone/crn_hparams/cancer_sim_subgroup='2'", 'exp.seed=10']
urllib3.exceptions.ResponseError: too many 500 error responses

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 944, in urlopen
    return self.urlopen(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 944, in urlopen
    return self.urlopen(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 944, in urlopen
    return self.urlopen(
  [Previous line repeated 2 more times]
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 934, in urlopen
    retries = retries.increment(method, url, response=response, _pool=self)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/runs/create (Caused by ResponseError('too many 500 error responses'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 187, in http_request
    return _get_http_response_with_retries(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/request_utils.py", line 237, in _get_http_response_with_retries
    return session.request(method, url, allow_redirects=allow_redirects, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/requests/adapters.py", line 691, in send
    raise RetryError(e, request=request)
requests.exceptions.RetryError: HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/runs/create (Caused by ResponseError('too many 500 error responses'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "runnables/train_enc_dec.py", line 54, in main
    artifacts_path = hydra.utils.to_absolute_path(mlf_logger.experiment.get_run(mlf_logger.run_id).info.artifact_uri)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/loggers/base.py", line 42, in experiment
    return get_experiment() or DummyExperiment()
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py", line 48, in wrapped_fn
    return fn(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/loggers/base.py", line 40, in get_experiment
    return fn(self)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/pytorch_lightning/loggers/mlflow.py", line 170, in experiment
    run = self._mlflow_client.create_run(experiment_id=self._experiment_id, tags=resolve_tags(self.tags))
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/tracking/client.py", line 393, in create_run
    return self._tracking_client.create_run(experiment_id, start_time, tags, run_name)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 167, in create_run
    return self.store.create_run(
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 208, in create_run
    response_proto = self._call_endpoint(CreateRun, req_body)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 81, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 360, in call_endpoint
    response = http_request(**call_kwargs)
  File "/opt/hpcaas/.mounts/fs-08d5b24cdba02ca24/home/yilingliu/CausalTransformer/venv/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 210, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://127.0.0.1:5000/api/2.0/mlflow/runs/create failed with exception HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/runs/create (Caused by ResponseError('too many 500 error responses'))

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
