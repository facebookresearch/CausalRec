[2025-01-27 19:07:20,941][__main__][INFO] - 
model:
  dim_treatments: 4
  dim_vitals: 0
  dim_static_features: 1
  dim_outcomes: 1
  name: MSM
  lag_features: 1
  propensity_treatment:
    _target_: src.models.msm.MSMPropensityTreatment
  propensity_history:
    _target_: src.models.msm.MSMPropensityHistory
  msm_regressor:
    _target_: src.models.msm.MSMRegressor
dataset:
  val_batch_size: 512
  treatment_mode: multilabel
  _target_: src.data.SyntheticCancerDatasetCollection
  name: tumor_generator
  coeff: 6.0
  chemo_coeff: 6.0
  radio_coeff: 6.0
  seed: 2
  random: false
  noise_percentage: 0.0
  num_patients:
    train: 10000
    val: 1000
    test: 1000
  window_size: 15
  lag: 0
  max_seq_length: 60
  projection_horizon: 5
  cf_seq_mode: sliding_treatment
exp:
  seed: 2
  gpus:
  - 0
  max_epochs: 100
  logging: true
  mlflow_uri: http://127.0.0.1:5000
  unscale_rmse: true
  percentage_rmse: true
  alpha: 1.0
  update_alpha: false
  alpha_rate: exp
  initial_balancing_method: null
  final_balancing_method: null
  bce_weight: false
  weights_ema: true
  beta: 0.99
  alpha_wass: 0.0001
  alpha_wass_epoch: false
  alpha_wass_growth: 0.001
  alpha_wass_max: 0.01

[2025-01-27 19:07:20,952][root][INFO] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528
[2025-01-27 19:07:20,953][root][INFO] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772
[2025-01-27 19:07:20,954][root][INFO] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796
[2025-01-27 19:07:20,955][root][INFO] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155
[2025-01-27 19:07:20,957][root][INFO] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307
[2025-01-27 19:07:20,966][root][INFO] - Got correlated params for 4629 patients
[2025-01-27 19:07:20,971][root][INFO] - Got correlated params for 9244 patients
[2025-01-27 19:07:20,976][root][INFO] - Got correlated params for 13793 patients
[2025-01-27 19:07:20,983][root][INFO] - Simulating beta_c parameters
[2025-01-27 19:07:20,987][root][INFO] - Randomising outputs
[2025-01-27 19:07:38,166][root][INFO] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528
[2025-01-27 19:07:38,169][root][INFO] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772
[2025-01-27 19:07:38,170][root][INFO] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796
[2025-01-27 19:07:38,170][root][INFO] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155
[2025-01-27 19:07:38,171][root][INFO] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307
[2025-01-27 19:07:38,173][root][INFO] - Got correlated params for 464 patients
[2025-01-27 19:07:38,174][root][INFO] - Got correlated params for 933 patients
[2025-01-27 19:07:38,175][root][INFO] - Got correlated params for 1413 patients
[2025-01-27 19:07:38,177][root][INFO] - Simulating beta_c parameters
[2025-01-27 19:07:38,178][root][INFO] - Randomising outputs
[2025-01-27 19:07:39,912][root][INFO] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528
[2025-01-27 19:07:39,913][root][INFO] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772
[2025-01-27 19:07:39,914][root][INFO] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796
[2025-01-27 19:07:39,914][root][INFO] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155
[2025-01-27 19:07:39,915][root][INFO] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307
[2025-01-27 19:07:39,917][root][INFO] - Got correlated params for 455 patients
[2025-01-27 19:07:39,918][root][INFO] - Got correlated params for 907 patients
[2025-01-27 19:07:39,919][root][INFO] - Got correlated params for 1382 patients
[2025-01-27 19:07:39,920][root][INFO] - Simulating beta_c parameters
[2025-01-27 19:07:39,921][root][INFO] - Randomising outputs
[2025-01-27 19:07:46,214][root][INFO] - Simulating initial volumes for stage I  with norm params: mu=1.72, sigma=4.7, lb=-0.6221218732608373, ub=-0.023523848418276528
[2025-01-27 19:07:46,216][root][INFO] - Simulating initial volumes for stage II  with norm params: mu=1.96, sigma=1.63, lb=-1.9410876100159118, ub=0.3711345751297772
[2025-01-27 19:07:46,217][root][INFO] - Simulating initial volumes for stage IIIA  with norm params: mu=1.91, sigma=9.4, lb=-0.33127370258786554, ub=0.06967546355973796
[2025-01-27 19:07:46,217][root][INFO] - Simulating initial volumes for stage IIIB  with norm params: mu=2.76, sigma=6.87, lb=-0.5769974969906748, ub=-0.02839165102452155
[2025-01-27 19:07:46,218][root][INFO] - Simulating initial volumes for stage IV  with norm params: mu=3.86, sigma=8.82, lb=-0.5741465764541877, ub=-0.14683113860980307
[2025-01-27 19:07:46,220][root][INFO] - Got correlated params for 439 patients
[2025-01-27 19:07:46,221][root][INFO] - Got correlated params for 899 patients
[2025-01-27 19:07:46,222][root][INFO] - Got correlated params for 1336 patients
[2025-01-27 19:07:46,223][root][INFO] - Simulating beta_c parameters
[2025-01-27 19:07:46,224][root][INFO] - Randomising outputs
[2025-01-27 19:08:15,222][src.data.cancer_sim.dataset][INFO] - Processing train dataset before training
[2025-01-27 19:08:15,260][src.data.cancer_sim.dataset][INFO] - Shape of processed train data: {'cancer_volume': (10000, 60), 'chemo_dosage': (10000, 60), 'radio_dosage': (10000, 60), 'chemo_application': (10000, 60), 'radio_application': (10000, 60), 'chemo_probabilities': (10000, 60), 'radio_probabilities': (10000, 60), 'sequence_lengths': (10000,), 'death_flags': (10000, 60), 'recovery_flags': (10000, 60), 'patient_types': (10000,), 'prev_treatments': (10000, 59, 2), 'current_treatments': (10000, 59, 2), 'current_covariates': (10000, 59, 2), 'outputs': (10000, 59, 1), 'active_entries': (10000, 59, 1), 'unscaled_outputs': (10000, 59, 1), 'prev_outputs': (10000, 59, 1), 'static_features': (10000, 1)}
[2025-01-27 19:08:15,261][src.data.cancer_sim.dataset][INFO] - Processing val dataset before training
[2025-01-27 19:08:15,265][src.data.cancer_sim.dataset][INFO] - Shape of processed val data: {'cancer_volume': (1000, 60), 'chemo_dosage': (1000, 60), 'radio_dosage': (1000, 60), 'chemo_application': (1000, 60), 'radio_application': (1000, 60), 'chemo_probabilities': (1000, 60), 'radio_probabilities': (1000, 60), 'sequence_lengths': (1000,), 'death_flags': (1000, 60), 'recovery_flags': (1000, 60), 'patient_types': (1000,), 'prev_treatments': (1000, 59, 2), 'current_treatments': (1000, 59, 2), 'current_covariates': (1000, 59, 2), 'outputs': (1000, 59, 1), 'active_entries': (1000, 59, 1), 'unscaled_outputs': (1000, 59, 1), 'prev_outputs': (1000, 59, 1), 'static_features': (1000, 1)}
[2025-01-27 19:08:15,265][src.data.cancer_sim.dataset][INFO] - Processing test dataset before training
[2025-01-27 19:08:16,119][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'cancer_volume': (228816, 60), 'chemo_application': (228816, 60), 'radio_application': (228816, 60), 'sequence_lengths': (228816,), 'patient_types': (228816,), 'prev_treatments': (228816, 59, 2), 'current_treatments': (228816, 59, 2), 'current_covariates': (228816, 59, 2), 'outputs': (228816, 59, 1), 'active_entries': (228816, 59, 1), 'unscaled_outputs': (228816, 59, 1), 'prev_outputs': (228816, 59, 1), 'static_features': (228816, 1)}
[2025-01-27 19:08:16,120][src.data.cancer_sim.dataset][INFO] - Processing test dataset before training
[2025-01-27 19:08:18,421][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'cancer_volume': (569417, 65), 'chemo_application': (569417, 65), 'radio_application': (569417, 65), 'sequence_lengths': (569417,), 'patient_types': (569417,), 'patient_ids_all_trajectories': (569417,), 'patient_current_t': (569417,), 'prev_treatments': (569417, 64, 2), 'current_treatments': (569417, 64, 2), 'current_covariates': (569417, 64, 2), 'outputs': (569417, 64, 1), 'active_entries': (569417, 64, 1), 'unscaled_outputs': (569417, 64, 1), 'prev_outputs': (569417, 64, 1), 'static_features': (569417, 1)}
[2025-01-27 19:08:18,423][src.data.cancer_sim.dataset][INFO] - Processing test dataset before testing (multiple sequences)
[2025-01-27 19:08:25,431][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'active_encoder_r': (569417, 59), 'prev_treatments': (569417, 5, 2), 'current_treatments': (569417, 5, 2), 'current_covariates': (569417, 5, 2), 'prev_outputs': (569417, 5, 1), 'static_features': (569417, 1), 'outputs': (569417, 5, 1), 'sequence_lengths': (569417,), 'active_entries': (569417, 5, 1), 'unscaled_outputs': (569417, 5, 1), 'patient_types': (569417,), 'patient_ids_all_trajectories': (569417,), 'patient_current_t': (569417,)}
[2025-01-27 19:08:26,929][src.models.msm][INFO] - Input size of propensity_treatment: 2
[2025-01-27 19:08:27,795][src.data.cancer_sim.dataset][INFO] - Exploding train dataset before testing (multiple sequences)
[2025-01-27 19:08:31,242][src.data.cancer_sim.dataset][INFO] - Shape of processed train data: {'prev_treatments': (565941, 59, 2), 'current_treatments': (565941, 59, 2), 'static_features': (565941, 1), 'prev_outputs': (565941, 59, 1), 'outputs': (565941, 59, 1), 'unscaled_outputs': (565941, 59, 1), 'sequence_lengths': (565941,), 'active_entries': (565941, 59, 1)}
[2025-01-27 19:08:34,184][src.models.msm][INFO] - Input size of propensity_history: 4
[2025-01-27 19:08:34,662][src.data.cancer_sim.dataset][INFO] - Exploding train dataset before testing (multiple sequences)
[2025-01-27 19:08:38,189][src.data.cancer_sim.dataset][INFO] - Shape of processed train data: {'prev_treatments': (565941, 59, 2), 'current_treatments': (565941, 59, 2), 'static_features': (565941, 1), 'prev_outputs': (565941, 59, 1), 'outputs': (565941, 59, 1), 'unscaled_outputs': (565941, 59, 1), 'sequence_lengths': (565941,), 'active_entries': (565941, 59, 1)}
[2025-01-27 19:08:42,878][src.models.msm][INFO] - Input size of msm_regressor: 4
[2025-01-27 19:08:43,346][src.models.msm][INFO] - Propensity scores for train.
[2025-01-27 19:08:43,411][src.data.cancer_sim.dataset][INFO] - Exploding train dataset before testing (multiple sequences)
[2025-01-27 19:08:46,988][src.data.cancer_sim.dataset][INFO] - Shape of processed train data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:08:48,049][src.models.msm][INFO] - Propensity scores for train.
[2025-01-27 19:08:48,094][src.data.cancer_sim.dataset][INFO] - Exploding train dataset before testing (multiple sequences)
[2025-01-27 19:08:51,680][src.data.cancer_sim.dataset][INFO] - Shape of processed train data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:08:53,362][src.data.cancer_sim.dataset][INFO] - Exploding train dataset before testing (multiple sequences)
[2025-01-27 19:08:57,290][src.data.cancer_sim.dataset][INFO] - Shape of processed train data: {'prev_treatments': (565941, 59, 2), 'current_treatments': (565941, 59, 2), 'static_features': (565941, 1), 'prev_outputs': (565941, 59, 1), 'outputs': (565941, 59, 1), 'unscaled_outputs': (565941, 59, 1), 'sequence_lengths': (565941,), 'active_entries': (565941, 59, 1), 'stabilized_weights': (565941, 59)}
[2025-01-27 19:09:00,599][src.data.cancer_sim.dataset][INFO] - Exploding train dataset before testing (multiple sequences)
[2025-01-27 19:09:04,480][src.data.cancer_sim.dataset][INFO] - Shape of processed train data: {'prev_treatments': (555951, 59, 2), 'current_treatments': (555951, 59, 2), 'static_features': (555951, 1), 'prev_outputs': (555951, 59, 1), 'outputs': (555951, 59, 1), 'unscaled_outputs': (555951, 59, 1), 'sequence_lengths': (555951,), 'active_entries': (555951, 59, 1), 'stabilized_weights': (555951, 59)}
[2025-01-27 19:09:07,996][src.data.cancer_sim.dataset][INFO] - Exploding train dataset before testing (multiple sequences)
[2025-01-27 19:09:11,792][src.data.cancer_sim.dataset][INFO] - Shape of processed train data: {'prev_treatments': (546043, 59, 2), 'current_treatments': (546043, 59, 2), 'static_features': (546043, 1), 'prev_outputs': (546043, 59, 1), 'outputs': (546043, 59, 1), 'unscaled_outputs': (546043, 59, 1), 'sequence_lengths': (546043,), 'active_entries': (546043, 59, 1), 'stabilized_weights': (546043, 59)}
[2025-01-27 19:09:15,252][src.data.cancer_sim.dataset][INFO] - Exploding train dataset before testing (multiple sequences)
[2025-01-27 19:09:18,992][src.data.cancer_sim.dataset][INFO] - Shape of processed train data: {'prev_treatments': (536168, 59, 2), 'current_treatments': (536168, 59, 2), 'static_features': (536168, 1), 'prev_outputs': (536168, 59, 1), 'outputs': (536168, 59, 1), 'unscaled_outputs': (536168, 59, 1), 'sequence_lengths': (536168,), 'active_entries': (536168, 59, 1), 'stabilized_weights': (536168, 59)}
[2025-01-27 19:09:22,419][src.data.cancer_sim.dataset][INFO] - Exploding train dataset before testing (multiple sequences)
[2025-01-27 19:09:26,046][src.data.cancer_sim.dataset][INFO] - Shape of processed train data: {'prev_treatments': (526315, 59, 2), 'current_treatments': (526315, 59, 2), 'static_features': (526315, 1), 'prev_outputs': (526315, 59, 1), 'outputs': (526315, 59, 1), 'unscaled_outputs': (526315, 59, 1), 'sequence_lengths': (526315,), 'active_entries': (526315, 59, 1), 'stabilized_weights': (526315, 59)}
[2025-01-27 19:09:29,401][src.data.cancer_sim.dataset][INFO] - Exploding train dataset before testing (multiple sequences)
[2025-01-27 19:09:32,988][src.data.cancer_sim.dataset][INFO] - Shape of processed train data: {'prev_treatments': (516484, 59, 2), 'current_treatments': (516484, 59, 2), 'static_features': (516484, 1), 'prev_outputs': (516484, 59, 1), 'outputs': (516484, 59, 1), 'unscaled_outputs': (516484, 59, 1), 'sequence_lengths': (516484,), 'active_entries': (516484, 59, 1), 'stabilized_weights': (516484, 59)}
[2025-01-27 19:09:36,472][src.models.time_varying_model][INFO] - RMSE calculation for test.
[2025-01-27 19:09:36,472][src.models.msm][INFO] - Predictions for test.
[2025-01-27 19:09:37,242][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:09:40,826][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:09:44,121][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:09:47,692][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:09:51,120][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:09:54,720][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:09:58,199][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:10:01,771][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:10:05,178][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:10:08,797][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:10:12,263][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:10:15,853][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:10:19,348][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:10:22,942][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:10:26,402][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:10:29,992][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:10:33,431][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:10:37,041][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:10:40,512][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:10:44,109][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:10:47,615][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:10:51,207][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:10:54,618][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:10:58,206][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:11:01,657][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:11:05,178][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:11:08,524][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:11:12,063][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:11:15,421][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:11:19,010][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:11:22,349][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:11:25,932][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:11:29,274][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:11:32,851][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:11:36,192][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:11:39,826][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:11:43,195][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:11:46,727][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:11:50,073][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:11:53,620][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:11:57,023][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:12:00,620][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:12:04,088][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:12:07,694][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (580000, 59, 2), 'current_treatments': (580000, 59, 2), 'static_features': (580000, 1), 'prev_outputs': (580000, 59, 1), 'outputs': (580000, 59, 1), 'unscaled_outputs': (580000, 59, 1), 'sequence_lengths': (580000,), 'active_entries': (580000, 59, 1)}
[2025-01-27 19:12:11,181][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2025-01-27 19:12:14,340][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (511328, 59, 2), 'current_treatments': (511328, 59, 2), 'static_features': (511328, 1), 'prev_outputs': (511328, 59, 1), 'outputs': (511328, 59, 1), 'unscaled_outputs': (511328, 59, 1), 'sequence_lengths': (511328,), 'active_entries': (511328, 59, 1)}
[2025-01-27 19:12:17,364][__main__][INFO] - Test normalised RMSE (all): 4.113815671155656; Test normalised RMSE (orig): 3.658563641144949; Test normalised RMSE (only counterfactual): 3.3114794595830492
[2025-01-27 19:12:17,396][src.models.time_varying_model][INFO] - RMSE calculation for test.
[2025-01-27 19:12:17,396][src.models.msm][INFO] - Autoregressive Prediction for test.
[2025-01-27 19:12:33,653][__main__][INFO] - Test normalised RMSE (n-step prediction): {'2-step': 2.386109623068023, '3-step': 2.234726751157912, '4-step': 2.316731198353394, '5-step': 2.270761910115706, '6-step': 1.9955365124797977}
